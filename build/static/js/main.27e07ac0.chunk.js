/*! For license information please see main.27e07ac0.chunk.js.LICENSE.txt */
(this.webpackJsonpcityscopejs=this.webpackJsonpcityscopejs||[]).push([[0],{26:function(e){e.exports=JSON.parse('{"docsURL":"https://raw.githubusercontent.com/CityScope/CS_cityscopeJS/master/docs/","SOCKETS":{"URL":"ws://localhost:8080"},"cityIO":{"baseURL":"https://cityio.media.mit.edu/api/table/","ListOfTables":"https://cityio.media.mit.edu/api/tables/list/","interval":500,"cityIOmodules":[{"name":"header","expectUpdate":false},{"name":"GEOGRID","expectUpdate":false},{"name":"ABM2","expectUpdate":true},{"name":"geojson","expectUpdate":true},{"name":"grid","expectUpdate":false},{"name":"access","expectUpdate":true},{"name":"GEOGRIDDATA","expectUpdate":false},{"name":"indicators","expectUpdate":true},{"name":"textual","expectUpdate":true}]},"menu":{"toggles":{"GRID":{"displayName":"Interactive Grid","showOnInit":true,"requireModule":"GEOGRID"},"ABM":{"displayName":"Mobility Simulation","showOnInit":false,"requireModule":"ABM2"},"GEOJSON":{"displayName":"Geojson Layer","showOnInit":false,"requireModule":"geojson"},"AGGREGATED_TRIPS":{"displayName":"Aggregated Trips","showOnInit":false,"requireModule":"ABM2"},"ACCESS":{"displayName":"Accessibility Analysis","showOnInit":false,"requireModule":"access"},"ROTATE":{"displayName":"Rotate Camera","showOnInit":false,"requireModule":false},"TEXTUAL":{"displayName":"Toggle Information","showOnInit":true,"requireModule":"GEOGRID"},"SHADOWS":{"displayName":"Toggle Shadows","showOnInit":true,"requireModule":"GEOGRID"}}},"map":{"mapStyle":{"sat":"mapbox://styles/relnox/cjs9rb33k2pix1fo833uweyjd?fresh=true","blue":"mapbox://styles/relnox/ck0h5xn701bpr1dqs3he2lecq?fresh=true"},"layers":{"ABM":{"startSimHour":0,"endSimHour":86400,"currentSimHour":43200,"animationSpeed":20},"heatmap":{"colors":[[233,62,58],[237,104,60],[243,144,63],[253,199,12],[255,243,59]]}},"initialViewState":{"zoom":17,"pitch":0,"bearing":0}},"expressPort":3333}')},378:function(e,t){},577:function(e,t){},59:function(e){e.exports=JSON.parse('{"map":{"mapStyle":{"sat":"mapbox://styles/relnox/cjs9rb33k2pix1fo833uweyjd?fresh=true","dark":"mapbox://styles/relnox/cjl58dpkq2jjp2rmzyrdvfsds?fresh=true","blue":"mapbox://styles/relnox/ck0h5xn701bpr1dqs3he2lecq?fresh=true","custom":"mapbox://styles/vlab-company/ckdy9814i47lg19p7eh0ms8gb"},"projectName":"hcm_test_v1","gridTransparent":180},"GEOGRIDDATA":{"color":[0,0,0,0],"height":0,"id":0,"interactive":"Web","name":"name"},"GEOGRID":{"features":[],"properties":{"geogrid_to_tui_mapping":{},"header":{"cellSize":30,"latitude":10.759316,"longitude":106.705454,"tz":7,"ncols":20,"nrows":20,"rotation":0,"projection":"+proj=tmerc +lat_0=0 +lon_0=107.75 +k=0.9999 +x_0=500000 +y_0=0 +ellps=WGS84 +units=m +no_defs"},"types":{"Security land":{"TypeCode":"CAN","IDSColor":53,"RGB":"255,80,70","color":"#ff5046"},"Land with public purposes":{"TypeCode":"CCC","IDSColor":59,"RGB":"255,170,160","color":"#ffaaa0"},"Defense land":{"TypeCode":"CQP","IDSColor":52,"RGB":"255,100,80","color":"#ff6450"},"Land for post and telecommunications":{"TypeCode":"DBV","IDSColor":67,"RGB":"255,170,160","color":"#ffaaa0"},"Market land":{"TypeCode":"DCH","IDSColor":81,"RGB":"255,170,160","color":"#ffaaa0"},"Land with historical-cultural relics":{"TypeCode":"DDT","IDSColor":84,"RGB":"255,170,160","color":"#ffaaa0"},"Land for construction of education and training":{"TypeCode":"DGD","IDSColor":75,"RGB":"255,170,160","color":"#ffaaa0"},"Transportation QHSDDTNMT":{"TypeCode":"DGT","IDSColor":60,"RGB":"255,170,50","color":"#ffaa32"},"Land for energy facility":{"TypeCode":"DNL","IDSColor":66,"RGB":"255,170,160","color":"#ffaaa0"},"Land for disposal, waste treatment":{"TypeCode":"DRA","IDSColor":85,"RGB":"205,170,205","color":"#cdaacd"},"Irrigation land":{"TypeCode":"DTL","IDSColor":63,"RGB":"170,255,255","color":"#aaffff"},"Land for construction of offices of non - business units":{"TypeCode":"DTS","IDSColor":48,"RGB":"250,170,160","color":"#faaaa0"},"Land for construction of physical training and sport":{"TypeCode":"DTT","IDSColor":78,"RGB":"255,170,160","color":"#ffaaa0"},"Land for construction of cultural":{"TypeCode":"DVH","IDSColor":69,"RGB":"255,170,160","color":"#ffaaa0"},"Land for construction of health facilities":{"TypeCode":"DYT","IDSColor":72,"RGB":"255,170,160","color":"#ffaaa0"},"Urban residential land":{"TypeCode":"ODT","IDSColor":42,"RGB":"255,160,255","color":"#ffa0ff"},"Land non-agricultural production facilities":{"TypeCode":"SKC","IDSColor":56,"RGB":"250,170,160","color":"#faaaa0"},"Land with rivers, streams, canals, springs":{"TypeCode":"SON","IDSColor":91,"RGB":"160,255,255","color":"#a0ffff"},"Land for beliefs facility":{"TypeCode":"TIN","IDSColor":88,"RGB":"255,170,160","color":"#ffaaa0"},"Land for religious facility":{"TypeCode":"TON","IDSColor":87,"RGB":"255,170,160","color":"#ffaaa0"},"Land for construction of offices":{"TypeCode":"TSC","IDSColor":45,"RGB":"255,170,160","color":"#ffaaa0"},"Thematic park (amusement park)":{"TypeCode":"CXCD","IDSColor":94,"RGB":"0,127,0","color":"#007f00"},"Greenary - park land QHPK":{"TypeCode":"CXCL","IDSColor":126,"RGB":"0,76,57","color":"#004c39"},"Water surface QHPK":{"TypeCode":"MN","IDSColor":152,"RGB":"0,82,165","color":"#0052a5"},"Educational NCDT":{"TypeCode":"NCDT","IDSColor":144,"RGB":"0,95,127","color":"#005f7f"},"Educational GD2":{"TypeCode":"GD2","IDSColor":24,"RGB":"127,31,0","color":"#7f1f00"},"Office - production and trading":{"TypeCode":"CQCT","IDSColor":34,"RGB":"127,63,0","color":"#7f3f00"},"Educational GD1":{"TypeCode":"GD1","IDSColor":15,"RGB":"127,63,63","color":"#7f3f3f"},"School":{"TypeCode":"GD","IDSColor":15,"RGB":"127,63,63","color":"#7f3f3f"},"Existing and Renovated Residential":{"TypeCode":"NNO","IDSColor":42,"RGB":"165,124,0","color":"#a57c00"},"Wetland":{"TypeCode":"DK","IDSColor":254,"RGB":"204,204,204","color":"#cccccc"},"Public Facility":{"TypeCode":"CCDVO","IDSColor":1,"RGB":"255,0,0","color":"#ff0000"},"Resort/Outdoor entertainment":{"TypeCode":"CCDT","IDSColor":1,"RGB":"255,0,0","color":"#ff0000"},"Mixed-use":{"TypeCode":"HH","IDSColor":21,"RGB":"255,159,127","color":"#ff9f7f"},"Transportation QHPK":{"TypeCode":"DGT","IDSColor":7,"RGB":"255,255,255","color":"#ffffff"},"National defense - security":{"TypeCode":"ANQP","IDSColor":69,"RGB":"33,38,19","color":"#212613"},"Production land - warehouse":{"TypeCode":"KTBB","IDSColor":177,"RGB":"38,38,126","color":"#26267e"},"Sport - Greenery":{"TypeCode":"CXDVO","IDSColor":76,"RGB":"38,76,0","color":"#264c00"},"Religious":{"TypeCode":"TGDT","IDSColor":16,"RGB":"76,0,0","color":"#4c0000"},"Greenary - park land QHSSK":{"TypeCode":"CXDT","IDSColor":72,"RGB":"82,165,0","color":"#52a500"},"Technical Infrastructure":{"TypeCode":"HTKT","IDSColor":195,"RGB":"95,63,127","color":"#5f3f7f"},"Transportation QHSSK":{"TypeCode":"DGT","IDSColor":7,"RGB":"255,255,255","color":"#ffffff"},"Water surface":{"TypeCode":"MN","IDSColor":152,"RGB":"0,82,165","color":"#0052a5"},"Open Space":{"TypeCode":"CXCD","IDSColor":94,"RGB":"0,127,0","color":"#007f00"},"New Residential":{"TypeCode":"DVO","IDSColor":30,"RGB":"255,127,0","color":"#ff7f00"},"Hotel":{"TypeCode":"DL","IDSColor":210,"RGB":"255,0,255","color":"#ff00ff"},"Community":{"TypeCode":"CCDT","IDSColor":1,"RGB":"255,0,0","color":"#ff0000"},"Schools":{"TypeCode":"GD","IDSColor":15,"RGB":"127,63,63","color":"#7f3f3f"},"Religion - Relic":{"TypeCode":"TGDT","IDSColor":16,"RGB":"76,0,0","color":"#4c0000"},"Existing agency":{"TypeCode":"CQCT","IDSColor":34,"RGB":"127,63,0","color":"#7f3f00"},"Institutional Buildings":{"TypeCode":"NCDT","IDSColor":144,"RGB":"0,95,127","color":"#005f7f"},"Urban Hybrid":{"TypeCode":"HH","IDSColor":21,"RGB":"255,159,127","color":"#ff9f7f"},"Parking Garage":{"TypeCode":"HTKT","IDSColor":195,"RGB":"95,63,127","color":"#5f3f7f"},"Cemetery":{"TypeCode":"NT","IDSColor":251,"RGB":"101,101,101","color":"#656565"}}},"type":"FeatureCollection"}}')},660:function(e,t,a){},662:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(40),i=a.n(o),c=a(142),s=a(46),l=a(693),u=a(435),d=a(496),p=Object(u.a)((function(){return Object(d.a)({"@global":{"*":{boxSizing:"border-box",margin:0,padding:0},html:{"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",height:"100%",width:"100%"},body:{backgroundColor:"#18191a",height:"100%",width:"100%"},a:{textDecoration:"none"},"#root":{height:"100%",width:"100%"}}})})),j=function(){return p(),null},b=a(193),h=a(35),f={fontFamily:'"Roboto Mono", sans-serif',fontSize:12,fontWeightLight:100,fontWeightRegular:500,fontWeightMedium:700,h1:{fontWeight:700,fontSize:45,letterSpacing:"-1px"},h2:{fontWeight:800,fontSize:29,letterSpacing:"-0.24px"},h3:{fontWeight:700,fontSize:24,letterSpacing:"-0.06px"},h4:{fontWeight:500,fontSize:20,letterSpacing:"-0.06px"},h5:{fontWeight:500,fontSize:16,letterSpacing:"-0.05px"},h6:{fontWeight:500,fontSize:14,letterSpacing:"-0.05px"},overline:{fontWeight:500}},O=Object(b.a)({zIndex:{appBar:999},palette:{background:{default:"#ff5278",paper:"#18191a",dark:"#ff5278"},primary:{main:"#FFF",light:"#ff5278"},secondary:{main:"#ff5278"},text:{primary:h.colors.grey[100],secondary:"#ff5278"}},typography:f,shape:{borderRadius:20},overrides:{MuiListItem:{root:{"&$selected":{backgroundColor:"#18191a",boxShadow:"12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)","&:hover":{backgroundColor:"#ff5278"}}},button:{"&:hover":{backgroundColor:"#ff5278"}}},MuiOutlinedInput:{notchedOutline:{borderColor:"#ff5278"}},MuiAppBar:{colorPrimary:{backgroundColor:"#18191a",color:"#FFF"}},MuiDivider:{root:{backgroundColor:"#FFF",opacity:.1}},MuiCard:{root:{boxShadow:"12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)"}},MuiButton:{root:{boxShadow:"12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)","&:hover":{boxShadow:"12px 12px 16px 0  #000,-2px -2px 16px 0  #ff5278"}}}}}),m=a(19),g=a(251),v=a.n(g),x=a(504),y=a.n(x),S=a(368),C=a(671),D=a(696),T=a(697),I=a(706),E=a(107),w=a(108),R=a(718),M=a(719),G=a(16),A=a(213),N=a(6),k=a(672),_=a(436),L=a(3),B=Object(u.a)((function(e){return{item:{display:"flex",paddingTop:0,paddingBottom:0},button:{color:e.palette.text.main,fontWeight:e.typography.fontWeightMedium,justifyContent:"flex-start",letterSpacing:0,padding:"10px 8px",textTransform:"none",width:"100%"},icon:{marginRight:e.spacing(1)},title:{marginRight:"auto"},active:{color:e.palette.text.secondary,"& $title":{fontWeight:e.typography.fontWeightBold},"& $icon":{color:e.palette.text.secondary}}}})),P=function(e){var t=e.className,a=e.href,n=e.icon,r=e.title,o=Object(A.a)(e,["className","href","icon","title"]),i=B();return Object(L.jsx)(k.a,Object(G.a)(Object(G.a)({className:Object(N.a)(i.item,t),disableGutters:!0},o),{},{children:Object(L.jsxs)(_.a,{activeClassName:i.active,className:i.button,component:c.c,to:a,children:[n&&Object(L.jsx)(n,{className:i.icon,size:"20"}),Object(L.jsx)("span",{className:i.title,children:r})]})}))},F=[{href:"/",icon:R.a,title:"CityScopeJS"},{href:"/editor",icon:M.a,title:"Grid Editor"},{href:"/projection",icon:y.a,title:"Projection Mapping"}],z=Object(u.a)((function(){return{mobileDrawer:{width:"30vw",top:48,height:"calc(100% - 48px)",boxShadow:"22px 22px 22px 0 rgba(0,0,0)"}}})),W=function(e){var t=e.openNavDrawer,a=e.onMobileNavOpen,n=z(),r=Object(L.jsxs)(S.a,{height:"100%",display:"flex",flexDirection:"column",p:3,children:[Object(L.jsx)(C.a,{children:F.map((function(e){return Object(L.jsx)(P,{style:{padding:"2vh"},href:e.href,title:e.title,icon:e.icon,onClick:a},e.title)}))}),Object(L.jsx)(S.a,{flexGrow:1}),Object(L.jsx)(D.a,{elevation:5,p:2,children:Object(L.jsxs)(T.a,{position:"bottom",children:[Object(L.jsx)(I.a,{href:"http://github.com/CityScope/CS_cityscopeJS/",color:"default",size:"small",children:Object(L.jsx)(v.a,{})}),Object(L.jsx)(S.a,{p:2}),Object(L.jsx)(E.a,{align:"left",variant:"h5",children:"MIT CityScope"}),Object(L.jsx)(E.a,{align:"left",variant:"caption",children:(new Date).getFullYear()})]})})]});return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(w.a,{anchor:"left",classes:{paper:n.mobileDrawer},open:t,elevation:10,variant:"persistent",children:r})})};W.defaultProps={onMobileClose:function(){},openNavDrawer:!1};var U=W,Y=a(695),H=a(448),V=a(370),J=a(505),K=a.n(J),X=Object(u.a)((function(){return{root:{}}})),q=function(e){var t=e.className,a=e.onMobileNavOpen,n=Object(A.a)(e,["className","onMobileNavOpen"]),r=X();return Object(L.jsx)(Y.a,Object(G.a)(Object(G.a)({className:Object(N.a)(r.root,t),elevation:5},n),{},{children:Object(L.jsxs)(H.a,{variant:"dense",children:[Object(L.jsx)(V.a,{color:"inherit",onClick:a,children:Object(L.jsx)(K.a,{})}),Object(L.jsx)(c.b,{to:"/",children:Object(L.jsx)(E.a,{className:r.name,color:"textPrimary",variant:"h5",children:"MIT CityScope"})})]})}))},Q=Object(u.a)((function(e){return{root:{backgroundColor:e.palette.background,display:"flex",height:"100%",overflow:"hidden",width:"100%"},content:{paddingTop:48,flex:"1 1 auto",height:"100vh",overflow:"auto"}}})),Z=function(){var e=Q(),t=Object(n.useState)(!0),a=Object(m.a)(t,2),r=a[0],o=a[1];return Object(L.jsxs)("div",{className:e.root,children:[Object(L.jsx)(U,{openNavDrawer:!r,onMobileNavOpen:function(){return o(!r)}}),Object(L.jsx)(q,{onMobileNavOpen:function(){return o(!r)}}),Object(L.jsx)("div",{className:e.content,children:Object(L.jsx)(s.b,{})})]})},$=a(698),ee=a(506),te=Object(n.forwardRef)((function(e,t){var a=e.children,n=e.title,r=void 0===n?"":n,o=Object(A.a)(e,["children","title"]);return Object(L.jsxs)("div",Object(G.a)(Object(G.a)({ref:t},o),{},{children:[Object(L.jsx)(ee.a,{children:Object(L.jsxs)("title",{children:["CityScopeJS ",">"," ",r]})}),a]}))})),ae=Object(u.a)((function(e){return{root:{backgroundColor:e.palette.background,height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)},image:{marginTop:50,display:"inline-block",maxWidth:"100%",width:560}}})),ne=function(){var e=ae();return Object(L.jsx)(te,{className:e.root,title:"404",children:Object(L.jsx)(S.a,{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",children:Object(L.jsxs)($.a,{maxWidth:"md",children:[Object(L.jsx)(E.a,{align:"center",color:"textPrimary",variant:"h1",children:"404"}),Object(L.jsx)(E.a,{align:"center",color:"textPrimary",variant:"h5",children:"The page you are looking for isn\u2019t here"})]})})})},re=a(204),oe=a(205),ie=a(214),ce=a(211);function se(e){if(!e.mousePos)return null;var t=e.mousePos,a=e.selectedType,n=e.divSize,r="rgba("+a.color[0]+","+a.color[1]+","+a.color[2]+",0.6)",o=t.clientX-n/2,i=t.clientY-n/2;return Object(L.jsx)("div",{style:{border:"2px solid",backgroundColor:e.mouseDown?r:"rgba(0,0,0,0)",borderColor:a.color,color:a.color,borderRadius:"15%",position:"fixed",zIndex:1,pointerEvents:"none",width:n,height:n,left:o,top:i},children:Object(L.jsx)("div",{style:{position:"relative",left:n+10,fontSize:"0.5em"},children:a.name})})}var le=a(21),ue=a(160),de=a(727),pe=(a(276),a(730)),je=a(59),be="GET_CITYIO_DATA";function he(e){return{type:be,data:e}}var fe="LISTEN_TO_MAP_EVENTS";var Oe="LISTEN_TO_ABM_SLIDERS";function me(e){return{type:Oe,data:e}}var ge="LISTEN_TO_ABM_MODE";var ve="LISTEN_TO_ACCESS_TOGGLE";var xe="MENU_INTERACTION";function ye(e){return{type:xe,data:e}}var Se="LISTEN_TO_EDIT_MENU";function Ce(e){return{type:Se,data:e}}var De="SET_READY_STATE";function Te(e){return{type:De,data:e}}var Ie="SET_LOADING_STATE";function Ee(e){return{type:Ie,data:e}}var we="SET_SCENARIO_NAMES";function Re(e){return{type:we,data:e}}var Me="ADD_LOADING_MODULES";function Ge(e){return{type:Me,data:e}}var Ae="REMOVE_LOADING_MODULES";function Ne(e){return{type:Ae,data:e}}var ke="SET_CURRENT_VIEW_OPTION";var _e="SET_UI_WEBSOCKET_DATA";var Le="SET_UI_WEBSOCKET_READY";var Be="LISTEN_TO_GRID_CREATOR";function Pe(e){return{type:Be,data:e}}var Fe="LISTEN_TO_ROW_EDIT";function ze(e){return{type:Fe,data:e}}var We="LISTEN_TO_TYPES_LIST";var Ue="LISTEN_TO_BASE_MAP_CENTER";function Ye(e){return{type:Ue,data:e}}var He=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),je.map.gridTransparent]:null},Ve=function(e){Object(ie.a)(a,e);var t=Object(ce.a)(a);function a(e){var n;return Object(re.a)(this,a),(n=t.call(this,e))._toggleOrthoView=function(e){e.orthographic=!!n.props.menu.includes("RESET_VIEW")},n._onViewStateChange=function(e){var t=e.viewState;n.setState({viewState:t})},n.componentDidUpdate=function(e){n.props.mapCenter!==e.mapCenter&&n.setState({viewState:Object(G.a)(Object(G.a)({},n.state.viewState),{},{latitude:n.props.mapCenter.latCenter,longitude:n.props.mapCenter.lonCenter,pitch:0,bearing:0,orthographic:!1})})},n._mulipleObjPicked=function(e){var t=n.state.pickingRadius,a=e.x-t/2,r=e.y-t/2;return n.deckGL.pickObjects({x:a,y:r,width:t,height:t})},n._handleGridcellEditing=function(e){if(n.props.selectedType){var t=n.props.selectedType,a=t.height,r=t.name,o=t.color,i=t.interactive,c=n._mulipleObjPicked(e);c.forEach((function(e){var t=e.object.properties;t.color=He(o),t.height=parseInt(a),t.name=r,"No"!==i?t.interactive=i:delete t.interactive})),n.setState({selectedCellsState:c})}},n._renderSelectionTarget=function(){return n.props.selectedType&&Object(L.jsx)(se,{mousePos:n.state.mousePos,selectedType:n.props.selectedType,divSize:n.state.pickingRadius,mouseDown:n.state.mouseDown})},n._handleKeyUp=function(){n.setState({keyDownState:null})},n._handleKeyDown=function(e){n.setState({keyDownState:e.nativeEvent.key})},n.state={selectedType:null,draggingWhileEditing:!1,selectedCellsState:null,pickingRadius:40,viewState:je.map.initialViewState},n.dirLightSettings={timestamp:Date.UTC(2019,7,1,12),color:[255,255,255],intensity:1,_shadow:!0},n}return Object(oe.a)(a,[{key:"componentDidMount",value:function(){this._rightClickViewRotate(),this._setViewStateToTableHeader()}},{key:"_setViewStateToTableHeader",value:function(){this.setState({viewState:Object(G.a)(Object(G.a)({},this.state.viewState),{},{latitude:je.GEOGRID.properties.header.latitude,longitude:je.GEOGRID.properties.header.longitude,zoom:15,pitch:0,bearing:0,orthographic:!0})})}},{key:"_rightClickViewRotate",value:function(){document.getElementById("deckgl-wrapper").addEventListener("contextmenu",(function(e){return e.preventDefault()}))}},{key:"_renderLayers",value:function(){var e=this,t=[];return t.push(new pe.a({id:"GRID",opacity:.5,stroked:!1,filled:!0,wireframe:!0,data:this.props.createdGrid,visible:!0,pickable:!0,extruded:!0,lineWidthScale:1,lineWidthMinPixels:1,getElevation:function(e){return e.properties.height},getFillColor:function(e){return e.properties.color},onClick:function(t,a){a.rightButton||"Shift"===e.state.keyDownState||e._handleGridcellEditing(t)},onDrag:function(t,a){a.rightButton||"Shift"===e.state.keyDownState||e._handleGridcellEditing(t)},onDragStart:function(t,a){a.rightButton||"Shift"===e.state.keyDownState||e.setState({draggingWhileEditing:!0})},onDragEnd:function(){e.setState({draggingWhileEditing:!1})},updateTriggers:{getFillColor:this.state.selectedCellsState,getElevation:this.state.selectedCellsState},transitions:{getFillColor:500,getElevation:500}})),t}},{key:"render",value:function(){var e=this;return Object(L.jsxs)("div",{className:"baseMap",onKeyDown:this._handleKeyDown,onKeyUp:this._handleKeyUp,onMouseMove:function(t){return e.setState({mousePos:t.nativeEvent})},onMouseUp:function(){return e.setState({mouseDown:!1})},onMouseDown:function(){return e.setState({mouseDown:!0})},children:[this._renderSelectionTarget(),Object(L.jsx)(de.a,{ref:function(t){e.deckGL=t&&t.deck},viewState:this.state.viewState,onViewStateChange:this._onViewStateChange,layers:this._renderLayers(),controller:{touchZoom:!0,touchRotate:!0,dragPan:!this.state.draggingWhileEditing,dragRotate:!this.state.draggingWhileEditing,keyboard:!1},children:Object(L.jsx)(ue.a,{dragRotate:!0,reuseMaps:!0,mapboxApiAccessToken:"pk.eyJ1IjoidmxhYi1jb21wYW55IiwiYSI6ImNrZHM3aXc0ZDE0bXUzM2p6OG1zNzJmYWEifQ.MKr7Fn4bDrTQiCEwJcuo1A",mapStyle:je.map.mapStyle.sat,preventStyleDiffing:!0})})]})}}]),a}(n.Component),Je={listenToBaseMapCenter:Ye},Ke=Object(le.b)((function(e){return{selectedType:e.ROW_EDIT,mapCenter:e.BASE_MAP_CENTER,createdGrid:e.GRID_CREATED}}),Je)(Ve),Xe=a(67),qe=a(515),Qe=a.n(qe),Ze=a(707);function $e(){var e=r.a.useState({columns:[{title:"Type",field:"name"},{title:"Description",field:"description"},{title:"Height",field:"height",type:"numeric"},{title:"Interactive",field:"interactive",lookup:{No:"No",Web:"Web",TUI:"TUI"}},{title:"Color",field:"color",type:"string"},{title:"LBCS",field:"LBCS",type:"string"},{title:"NAICS",field:"NAICS",type:"string"}],data:function(e){var t=[];return Object.keys(e).forEach((function(a){t.push({name:a,description:"description for: "+a,color:e[a].color,height:e[a].height?e[a].height:0,LBCS:e[a].LBCS?JSON.stringify(e[a].LBCS):null,NAICS:e[a].NAICS?JSON.stringify(e[a].NAICS):null,interactive:e[a].interactive?e[a].interactive:"web",TypeCode:e[a].TypeCode?e[a].TypeCode:null,IDSColor:e[a].IDSColor?e[a].IDSColor:null,RGB:e[a].RGB?e[a].RGB:null})})),t}(je.GEOGRID.properties.types)}),t=Object(m.a)(e,2),a=t[0],o=t[1],i=Object(le.c)(),c=Object(n.useState)(null),s=Object(m.a)(c,2),l=s[0],u=s[1],d=Object(n.useState)(null),p=Object(m.a)(d,2),j=p[0],b=p[1];return Object(n.useEffect)((function(){var e;i((e=a.data,{type:We,data:e}))})),Object(L.jsx)(Ze.a,{container:!0,children:Object(L.jsx)(Ze.a,{item:!0,xs:12,s:12,m:12,l:12,xl:12,children:Object(L.jsx)(Qe.a,{title:Object(L.jsx)(E.a,{variant:"h2",children:"Types Editor"}),columns:a.columns,data:a.data,options:{paging:!1,search:!0,selection:!1,rowStyle:function(e){return{fontFamily:"Roboto Mono",fontSize:12,backgroundColor:l===e.tableData.id?j:null}}},onRowClick:function(e,t){u(t.tableData.id),b(t.color),i(ze(t))},editable:{onRowAdd:function(e){return new Promise((function(t){setTimeout((function(){t(),o((function(t){var a=Object(Xe.a)(t.data);return a.push(e),Object(G.a)(Object(G.a)({},t),{},{data:a})}))}),200)}))},onRowUpdate:function(e,t){return new Promise((function(a){setTimeout((function(){a(),t&&o((function(a){var n=Object(Xe.a)(a.data);return n[n.indexOf(t)]=e,Object(G.a)(Object(G.a)({},a),{},{data:n})})),i(ze(e))}),200)}))},onRowDelete:function(e){return new Promise((function(t){console.log(e),setTimeout((function(){t(),o((function(t){var a=Object(Xe.a)(t.data);return a.splice(a.indexOf(e),1),Object(G.a)(Object(G.a)({},t),{},{data:a})})),i(Pe(null))}),200)}))}}})})})}var et=a(103),tt=a(450),at=a(516),nt=a.n(at),rt=a(180),ot=a(26);a(325);function it(e){return e*Math.PI/180}function ct(e){return 180*e/Math.PI}var st=function(e){var t=Object.keys(e);return e[t[t.length*Math.random()<<0]]};function lt(e){var t=Object(le.c)(),a=Object(le.d)((function(e){return e})),n=function(){var n=function(e,t){for(var a=parseFloat(e.longitude),n=parseFloat(e.latitude),r=parseFloat(e.rotation),o=e.projection,i=parseFloat(e.cellSize),c=parseFloat(e.nrows),s=parseFloat(e.ncols),l=rt.a.defs("EPSG:4326"),u={lon:a,lat:n},d=(90-r+360)%360,p=i*s/6371e3,j=it(u.lat),b=it(u.lon),h=it(d),f=Math.asin(Math.sin(j)*Math.cos(p)+Math.cos(j)*Math.sin(p)*Math.cos(h)),O={lon:ct(b+Math.atan2(Math.sin(h)*Math.sin(p)*Math.cos(j),Math.cos(p)-Math.sin(j)*Math.sin(f))),lat:ct(f)},m=Object(rt.a)(l,o,[u.lon,u.lat]),g=Object(rt.a)(l,o,[O.lon,O.lat]),v=(g[1]-m[1])/(g[0]-m[0]),x=Math.atan(v),y=Math.cos(x),S=Math.sin(x),C=[],D=[],T=0;T<c;T++)for(var I=0;I<s;I++)C.push(I*i),D.push(-T*i);for(var E=[],w=[],R=0;R<C.length;R++)E.push(C[R]*y-D[R]*S),w.push(C[R]*S+D[R]*y);for(var M=[],G=[],A=0;A<E.length;A++)M.push(m[0]+E[A]),G.push(m[1]+w[A]);for(var N=M[1]-M[0],k=G[1]-G[0],_=M[s]-M[0],L=G[s]-G[0],B=[],P={type:"FeatureCollection",features:[]},F=t,z=0;z<M.length;z++){for(var W=st(F),U={type:"Feature",geometry:{type:"Polygon",coordinates:null},properties:{color:He(W.color),height:W.height,name:W.name,interactive:W.interactive,id:z}},Y=[[M[z],G[z]],[M[z]+_,G[z]+L],[M[z]+_+N,G[z]+L+k],[M[z]+N,G[z]+k],[M[z],G[z]]],H=[],V=0;V<5;V++){var J=Object(rt.a)(o,l,Y[V]);H.push(J)}U.geometry.coordinates=[H],B.push(U)}return P.features=B,P}(e.gridProps,a.TYPES_LIST);t(Pe(n))};return Object(L.jsx)(_.a,{onClick:function(){n()},variant:"outlined",color:"default",startIcon:Object(L.jsx)(nt.a,{}),children:"Create Grid"})}var ut=a(246),dt=a.n(ut),pt=a(517),jt=a.n(pt),bt=a(54),ht=a.n(bt),ft=a(708),Ot=function(e,t,a,n){var r=e,o={};return t.forEach((function(e){o[e.name]=e,o[e.name].LBCS="string"==typeof e.LBCS?JSON.parse(e.LBCS):e.LBCS,o[e.name].NAICS="string"==typeof e.NAICS?JSON.parse(e.NAICS):e.NAICS})),r.properties.types=o,r.properties.header=n,r.properties.header.longitude=parseFloat(r.properties.header.longitude),r.properties.header.latitude=parseFloat(r.properties.header.latitude),r.properties.header.rotation=parseFloat(r.properties.header.rotation),r.properties.header.nrows=parseFloat(r.properties.header.nrows),r.properties.header.ncols=parseFloat(r.properties.header.ncols),r.properties.header.cellSize=parseFloat(r.properties.header.cellSize),r.features=a,r};function mt(e){var t=r.a.useState(null),a=Object(m.a)(t,2),n=a[0],o=a[1],i=Object(le.d)((function(e){return e})),c=i.GRID_CREATED,s=function(){var t,a,n=je.GEOGRID,r=i.TYPES_LIST,c=ot.features,s=e.gridProps,l=Ot(n,r,c,s),u=function(e){var t=[];return e.forEach((function(e){t.push(e.properties)})),t}(c),d=l.properties.header.tableName.toLowerCase(),p="".concat(ot.cityIO.baseURL).concat(d,"/"),j={GEOGRID:l,GEOGRIDDATA:u};ht()((t=p,a=j,{method:"post",url:t,data:a,headers:{"Content-Type":"application/json",Accept:"application/json"}})).then((function(e){o(function(e,t){var a="https://cityscope.media.mit.edu/CS_cityscopeJS/?cityscope="+t;return Object(L.jsxs)(E.a,{color:"textPrimary",variant:"caption",children:["CityIO is ",e.data.status,". Grid deployed to"," ",Object(L.jsx)(ft.a,{color:"textSecondary",href:a,children:a})]})}(e,d))})).catch((function(e){return console.log("ERROR: ".concat(e))}))};return Object(L.jsx)(L.Fragment,{children:c&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_.a,{onClick:function(){s()},variant:"outlined",color:"default",startIcon:Object(L.jsx)(dt.a,{}),children:"Commit Grid to cityIO"}),Object(L.jsx)(_.a,{onClick:function(){!function(){var t=je.GEOGRID,a=i.TYPES_LIST,n=i.GRID_CREATED.features,r=e.gridProps,o=Ot(t,a,n,r),c="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(o)),s=document.createElement("a");s.setAttribute("href",c),s.setAttribute("download","grid.json"),document.body.appendChild(s),s.click(),s.remove()}()},variant:"outlined",color:"default",startIcon:Object(L.jsx)(jt.a,{}),children:"Download JSON"}),Object(L.jsxs)("div",{style:{width:"100%"},children:[" ",n]})]})})}var gt=a(518),vt=a.n(gt);function xt(e){var t=Object(le.c)();return Object(L.jsx)(_.a,{onClick:function(){t(Ye({latCenter:parseFloat(e.mapCenter[0]),lonCenter:parseFloat(e.mapCenter[1])}))},variant:"outlined",color:"default",startIcon:Object(L.jsx)(vt.a,{}),style:{fontSize:"12px"},children:"Center Map"})}function yt(){var e=Object(u.a)((function(e){return{notchedOutline:{borderWidth:"1px",borderColor:e.palette.text.secondary},root:{"& .MuiTextField-root":{margin:e.spacing(1),flexWrap:"wrap"},"& > *":{margin:e.spacing(1)}}}})),t=r.a.useState({tableName:je.map.projectName,latitude:je.GEOGRID.properties.header.latitude,longitude:je.GEOGRID.properties.header.longitude,tz:je.GEOGRID.properties.header.tz,nrows:je.GEOGRID.properties.header.nrows,ncols:je.GEOGRID.properties.header.nrows,rotation:je.GEOGRID.properties.header.rotation,cellSize:je.GEOGRID.properties.header.cellSize,projection:je.GEOGRID.properties.header.projection}),a=Object(m.a)(t,2),n=a[0],o=a[1],i=function(e){var t=e.target,a=t.id,r=t.value;o(Object(G.a)(Object(G.a)({},n),{},Object(et.a)({},a,r)))},c=e();return Object(L.jsxs)("form",{className:c.root,noValidate:!0,autoComplete:"off",children:[Object(L.jsx)(E.a,{variant:"h2",children:"Grid Properties"}),Object(L.jsx)("div",{className:c.root,children:Object(L.jsx)(tt.a,{InputProps:{classes:{notchedOutline:c.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"tableName",label:"CityScope Project Name",defaultValue:n.tableName})}),Object(L.jsxs)("div",{className:c.root,children:[Object(L.jsx)(tt.a,{InputProps:{classes:{notchedOutline:c.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"latitude",label:"Latitude",defaultValue:n.latitude,type:"number"}),Object(L.jsx)(tt.a,{InputProps:{classes:{notchedOutline:c.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"longitude",label:"Longitude",defaultValue:n.longitude,type:"number"}),Object(L.jsx)(tt.a,{InputProps:{classes:{notchedOutline:c.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"tz",label:"Time Zone (GMT)",defaultValue:n.tz,type:"number"})]}),Object(L.jsx)("div",{className:c.root,children:Object(L.jsx)(xt,{mapCenter:[n.latitude,n.longitude]})}),Object(L.jsxs)("div",{className:c.root,children:[Object(L.jsx)(tt.a,{onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"nrows",label:"Rows",defaultValue:n.nrows,type:"number",InputProps:{classes:{notchedOutline:c.notchedOutline},inputProps:{max:100,min:0}}}),Object(L.jsx)(tt.a,{onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"ncols",label:"Columns",defaultValue:n.ncols,type:"number",InputProps:{classes:{notchedOutline:c.notchedOutline},inputProps:{max:100,min:0}}}),Object(L.jsx)(tt.a,{onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"rotation",label:"Rotation (deg)",defaultValue:n.rotation,type:"number",InputProps:{classes:{notchedOutline:c.notchedOutline},inputProps:{max:360,min:0}}}),Object(L.jsx)(tt.a,{onChange:function(e){return i(e)},variant:"outlined",className:c.textField,id:"cellSize",label:"Cell Size (m^2)",defaultValue:n.cellSize,type:"number",InputProps:{classes:{notchedOutline:c.notchedOutline},inputProps:{max:1e3,min:0}}})]}),Object(L.jsx)("div",{className:c.root,children:Object(L.jsx)(tt.a,{InputProps:{classes:{notchedOutline:c.notchedOutline}},onChange:function(e){return i(e)},variant:"outlined",id:"projection",label:"Projection",defaultValue:n.projection,type:"string",helperText:"Default projection should work for most CityScope cases. Find specific projections at: https://epsg.io/"})}),Object(L.jsxs)("div",{className:c.root,children:[Object(L.jsx)(lt,{gridProps:n}),Object(L.jsx)(mt,{gridProps:n})]})]})}function St(){return Object(L.jsxs)(C.a,{children:[Object(L.jsx)(k.a,{children:Object(L.jsx)(E.a,{variant:"h1",children:"CityScope Grid Editor"})}),Object(L.jsx)(k.a,{children:Object(L.jsx)(E.a,{children:"This tool is for creating CityScope projects with virtual editable girds, types, and props, and deploy them to cityIO."})}),Object(L.jsx)(k.a,{children:Object(L.jsx)(yt,{})}),Object(L.jsx)(k.a,{children:Object(L.jsx)($e,{})})]})}var Ct=Object(u.a)((function(e){return{root:{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)}}}));function Dt(){var e=Ct();return Object(L.jsx)(te,{className:e.root,title:"Editor",children:Object(L.jsx)($.a,{maxWidth:!1,children:Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)(Ze.a,{container:!0,spacing:5,children:[Object(L.jsx)(Ze.a,{item:!0,xs:12,l:6,md:6,xl:4,children:Object(L.jsx)(D.a,{elevation:15,style:{maxHeight:"85vh",overflow:"auto"},children:Object(L.jsx)(T.a,{children:Object(L.jsx)(St,{})})})}),Object(L.jsx)(Ze.a,{item:!0,xs:12,l:6,md:6,xl:8,children:Object(L.jsx)(D.a,{elevation:15,style:{height:"85vh",width:"100%",position:"relative"},children:Object(L.jsx)(T.a,{children:Object(L.jsx)(Ke,{})})})})]})})})})}var Tt=a(39),It=a.n(Tt),Et=a(62),wt=a(210),Rt=function(e,t,a){var n="".concat(ot.cityIO.baseURL).concat(e,"/meta/hashes");ht.a.get(n).then((function(n){var r,o=Object.keys(n.data).filter((function(e){return e.includes("scenarios")})).map((function(e){return parseInt(e.replace("scenarios",""))})),i=[],c=Object(wt.a)(o);try{for(c.s();!(r=c.n()).done;){var s=r.value;i.push(Mt(e,s))}}catch(l){c.e(l)}finally{c.f()}Promise.all(i).then((function(e){t(e.map((function(e){return{name:e.data.name,id:e.data.id}}))),a&&a(!1)})).catch((function(e){return console.log("error getting scenario names",e)}))})).catch((function(e){console.log("Error getting scenarios",e)}))},Mt=function(e,t){var a="".concat(ot.cityIO.baseURL).concat(e,"/scenarios").concat(t,"/info/");return ht.a.get(a)},Gt=function(){var e=Object(Et.a)(It.a.mark((function e(t){var a;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();function At(e){var t=e.tableName,a=Object(n.useState)(null),r=Object(m.a)(a,2),o=r[0],i=r[1],c=Object(n.useState)({}),s=Object(m.a)(c,2),l=s[0],u=s[1],d="".concat(ot.cityIO.baseURL).concat(t,"/"),p=Object(le.d)((function(e){return e.CITYIO}));console.log("cityioData",p);var j=Object(le.c)();function b(){return h.apply(this,arguments)}function h(){return(h=Object(Et.a)(It.a.mark((function e(){var t;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt(d+"meta/id/");case 2:t=e.sent,o!==t&&i(t),setTimeout(b,ot.cityIO.interval);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=Object(Et.a)(It.a.mark((function e(){var a,n,r,o,i,c;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt(d+"meta/hashes/");case 2:return a=e.sent,n=[],r=[],(o=ot.cityIO.cityIOmodules.map((function(e){return e.name}))).forEach((function(e){l[e]!==a[e]?(n.push(Gt("".concat(d).concat(e,"/"))),r.push(e)):n.push(null)})),j(Ge(r)),e.next=10,Promise.all(n);case 10:i=e.sent,u(a),(c=o.reduce((function(e,t,a){return i[a]?(console.log("updating ".concat(t)),Object(G.a)(Object(G.a)({},e),{},Object(et.a)({},t,i[a]))):e}),p)).tableName=t,j(Ne(r)),j(he(c)),console.log("done updating from cityIO"),j(Te(!0)),j(Ee(!1));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var e=setTimeout(b,ot.cityIO.interval);return console.log("reading cityIO every"+ot.cityIO.interval+"ms"),function(){return clearTimeout(e)}}),[]),Object(n.useEffect)((function(){o&&(j(Ee(!0)),Rt(t,(function(e){return j(Re(e))})),function(){f.apply(this,arguments)}())}),[o]),null}var Nt=a(34),kt=a(741),_t=a(729),Lt=a(725),Bt=a(738),Pt=a(740),Ft=a(735),zt=a(528),Wt=a.p+"static/media/legoio.148c5ab6.png";function Ut(e){var t=e.clicked;return console.log(t.object),Object(L.jsx)(D.a,{elevation:15,style:{position:"relative",zIndex:100},children:Object(L.jsxs)(T.a,{children:[Object(L.jsxs)(E.a,{variant:"h2",color:"textPrimary",children:["CityScope ",t.object.tableName]}),Object(L.jsxs)(E.a,{children:[Object(L.jsx)(ft.a,{color:"secondary",href:"https://cityscope.media.mit.edu/CS_cityscopeJS/?cityscope="+t.object.tableName.toLowerCase(),children:"Go to project"})," ","or"," ",Object(L.jsx)(ft.a,{target:"blank",color:"secondary",href:t.object.tableURL,children:"view raw data on cityIO."})]})]})})}function Yt(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(),c=Object(m.a)(i,2),s=c[0],l=c[1],u=Object(n.useState)(),d=Object(m.a)(u,2),p=d[0],j=d[1],b={longitude:-71.060929,latitude:42.3545259,zoom:1,pitch:0,bearing:0,zHeight:2e6},h=Object(n.useState)(b),f=Object(m.a)(h,2),O=f[0],g=f[1],v=Object(n.useState)(O),x=Object(m.a)(v,2),y=x[0],S=x[1],C=!1;Object(n.useEffect)((function(){j(b.zoom),document.getElementById("deckgl-wrapper").addEventListener("contextmenu",(function(e){return e.preventDefault()}))}),[b.zoom]),Object(n.useEffect)((function(){var t=[];e.cityIOdata.forEach((function(e,a){var n=10*Math.random(),r=10*Math.random();t.push({tableURL:e.tableURL,tableName:e.tableName,index:a,tableHeader:e.tableHeader,coord:{from:[e.tableHeader.longitude,e.tableHeader.latitude],to:[e.tableHeader.longitude+n,e.tableHeader.latitude+r,b.zHeight]}})})),o(t)}),[e,b.zHeight]);var D=[new _t.a({data:"https://basemaps.cartocdn.com/rastertiles/dark_all/{z}/{x}/{y}.png",minZoom:0,maxZoom:19,tileSize:96,renderSubLayers:function(e){var t=e.tile.bbox,a=t.west,n=t.south,r=t.east,o=t.north;return new Bt.a(e,{data:null,image:e.data,_imageCoordinateSystem:Nt.a.CARTESIAN,bounds:[a,n,r,o]})}}),new Pt.a({id:"LineLayer",data:r,pickable:!0,getWidth:p<2?2:0,getSourcePosition:function(e){return e.coord.from},getTargetPosition:function(e){return e.coord.to},getColor:function(e){return[255,82,120]}}),new Ft.a({id:"text-layer",data:r,pickable:!0,getPosition:function(e){return e.coord.to},getText:function(e){return e.tableName},getColor:[255,82,120],getSize:p<2?0:5,getAngle:0,getPixelOffset:[10,5],getTextAnchor:"start",getAlignmentBaseline:"center"}),new zt.a({id:"icon-layer",data:r,pickable:!0,iconAtlas:Wt,onClick:function(e){S({longitude:e.object.coord.to[0],latitude:e.object.coord.to[1],zoom:3,pitch:0,bearing:0,transitionDuration:1e3,transitionInterpolator:new Lt.a}),l(e)},iconMapping:{marker:{x:0,y:0,width:768,height:768,mask:!1}},getIcon:function(e){return"marker"},sizeScale:1,getSize:p<5?30:15,getPosition:function(e){return[e.coord.to[0],e.coord.to[1],b.zHeight]}})];return Object(L.jsxs)(L.Fragment,{children:[s&&s.object&&Object(L.jsx)(Ut,{clicked:s}),Object(L.jsx)(de.a,{views:new kt.a,onHover:function(e){var t=e.object;return C=Boolean(t)},getCursor:function(e){return e.isDragging?"grabbing":C?"crosshair":"grab"},layers:D,controller:!0,initialViewState:y,onViewportChange:g,onViewStateChange:function(e){return j(e.viewState.zoom)},ContextProvider:ue.b.Provider})]})}function Ht(){var e=Object(n.useState)([]),t=Object(m.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!0),i=Object(m.a)(o,2),c=i[0],s=i[1],l=function(){var e=Object(Et.a)(It.a.mark((function e(){var t,a,n;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ot.cityIO.ListOfTables,e.next=3,ht.a.get(t);case 3:a=e.sent,n=a.data.map(function(){var e=Object(Et.a)(It.a.mark((function e(t){var a;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(ot.cityIO.baseURL).concat(t,"/"),e.abrupt("return",ht.a.get("".concat(a,"GEOGRID/properties/header/")).then((function(e){return r((function(n){return[].concat(Object(Xe.a)(n),[{tableURL:a,tableName:t,tableHeader:e.data}])}))})).catch((function(e){return console.log(e.toString())})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Promise.all(n).then((function(){}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){l().then(s(!1))}),[]),Object(L.jsx)(L.Fragment,{children:!c&&Object(L.jsx)(Yt,{cityIOdata:a})})}var Vt=a(705);function Jt(){var e=Object(n.useState)({author:"",branch:"",date:"",sha:"",link:""}),t=Object(m.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){fetch("https://api.github.com/repos/CityScope/CS_cityscopeJS/branches/master").then((function(e){e.json().then((function(e){r({author:e.commit.commit.author.name,date:e.commit.commit.author.date,sha:e.commit.sha})}))})).catch((function(e){console.log(e)}))}),[]),Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E.a,{color:"primary",variant:"h5",children:"CityScopeJS Development Tracking"}),Object(L.jsxs)(E.a,{color:"primary",children:["Author: ",JSON.parse(JSON.stringify(a.author))]}),Object(L.jsxs)(E.a,{color:"primary",children:["Date: ",JSON.parse(JSON.stringify(a.date))]}),Object(L.jsxs)(E.a,{color:"primary",children:["Hash: ",JSON.parse(JSON.stringify(a.sha))]})]})}var Kt=Object(u.a)((function(e){return{divider:{margin:e.spacing(2)}}}));function Xt(){var e=Kt();return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(D.a,{elevation:15,children:Object(L.jsxs)(T.a,{children:[Object(L.jsx)(E.a,{color:"textPrimary",variant:"h1",children:"MIT CityScope"}),Object(L.jsx)(Vt.a,{className:e.divider,light:!0}),Object(L.jsx)(E.a,{color:"textPrimary",variant:"h4",children:"MIT CityScope is an open-source urban modeling and simulation platform. CityScope allows users to examine different design alternatives, and observe their impact through multiple layers of urban analytics modules, such as traffic models, ABM simulation, urban access, economy, storm-water, noise and more."})]})}),Object(L.jsx)(Vt.a,{className:e.divider,light:!0}),Object(L.jsx)(D.a,{elevation:15,children:Object(L.jsxs)(T.a,{position:"bottom",children:[Object(L.jsx)(E.a,{color:"textPrimary",gutterBottom:!0,children:"MIT CityScopeJS open-source project is developed by MIT, the City Science Network, and contributers from all over the world."}),Object(L.jsx)(E.a,{children:Object(L.jsxs)(ft.a,{color:"secondary",href:"https://github.com/CityScope",target:"blank",children:[Object(L.jsx)(v.a,{fontSize:"small"})," Join the CityScope open-source development"]})})]})}),Object(L.jsx)(Vt.a,{className:e.divider,light:!0}),Object(L.jsx)(D.a,{elevation:15,children:Object(L.jsxs)(T.a,{position:"bottom",children:[Object(L.jsx)(E.a,{color:"textPrimary",gutterBottom:!0,children:"Map view is provided via CityIO, CityScope server."}),Object(L.jsx)(E.a,{children:Object(L.jsxs)(ft.a,{color:"secondary",href:"https://github.com/CityScope/CS_CityIO",target:"blank",children:[Object(L.jsx)(v.a,{fontSize:"small"})," ","https://github.com/CityScope/CS_CityIO"]})})]})}),Object(L.jsx)(Vt.a,{className:e.divider,light:!0}),Object(L.jsx)(D.a,{elevation:15,children:Object(L.jsx)(T.a,{position:"bottom",children:Object(L.jsx)(Jt,{})})})]})}function qt(){var e=Object(u.a)((function(e){return{root:{"& > *":{margin:"auto",height:"100%",padding:e.spacing(3)}},fixedPosition:{position:"relative",zIndex:100}}}))();return Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)(te,{className:e.root,title:"CityScope Projects List",children:[Object(L.jsx)("div",{style:{height:"50vh",width:"100%",position:"relative"},children:Object(L.jsx)(Ht,{})}),Object(L.jsx)($.a,{className:e.fixedPosition,children:Object(L.jsx)(Xt,{})})]})})}for(var Qt=a(441),Zt=function(){var e=Object(le.d)((function(e){return[e.LOADING_MODULES]})),t=Object(m.a)(e,1)[0];return Object(L.jsx)(L.Fragment,{children:t.map((function(e,t){return Object(L.jsxs)(S.a,{position:"fixed",bottom:50*t,right:"2vw",width:"10vw",zIndex:"101",margin:"0",children:[Object(L.jsx)(Qt.a,{color:"secondary"}),Object(L.jsx)(E.a,{variant:"h6",color:"primary",style:{marginRight:"10px"},children:e})]},e)}))})},$t=a(743),ea=a(709),ta=a(742),aa=a(711),na=a(694),ra=a(163),oa=Object.keys(ot.menu.toggles),ia=[],ca=0;ca<oa.length;ca++)Object.values(ot.menu.toggles)[ca].showOnInit&&ia.push(oa[ca]);var sa={MENU:ia,CITYIO:{},SCENARIO_NAMES:[],MAP:{},LOADING_MODULES:[],SLIDERS:{time:[ot.map.layers.ABM.startSimHour,ot.map.layers.ABM.currentSimHour,ot.map.layers.ABM.endSimHour],speed:ot.map.layers.ABM.animationSpeed},ABM_MODE:"mode",ACCESS_TOGGLE:0,SELECTED_TYPE:null,READY:!1,LOADING:!1,CURRENT_VIEW_OPTION:"",ROW_EDIT:null,BASE_MAP_CENTER:{latCenter:null,lonCenter:null},TYPES_LIST:null,GRID_CREATED:null};function la(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case be:return Object(G.a)(Object(G.a)({},e),{},{CITYIO:t.data});case xe:return Object(G.a)(Object(G.a)({},e),{},{MENU:t.data});case fe:return Object(G.a)(Object(G.a)({},e),{},{MAP:t.data});case Oe:return Object(G.a)(Object(G.a)({},e),{},{SLIDERS:t.data});case ge:return Object(G.a)(Object(G.a)({},e),{},{ABM_MODE:t.data});case ve:return Object(G.a)(Object(G.a)({},e),{},{ACCESS_TOGGLE:t.data});case Se:return Object(G.a)(Object(G.a)({},e),{},{SELECTED_TYPE:t.data});case De:return Object(G.a)(Object(G.a)({},e),{},{READY:t.data});case Ie:return Object(G.a)(Object(G.a)({},e),{},{LOADING:t.data});case we:return Object(G.a)(Object(G.a)({},e),{},{SCENARIO_NAMES:t.data});case Me:return Object(G.a)(Object(G.a)({},e),{},{LOADING_MODULES:Object(Xe.a)(new Set([].concat(Object(Xe.a)(e.LOADING_MODULES),Object(Xe.a)(t.data))))});case Ae:return Object(G.a)(Object(G.a)({},e),{},{LOADING_MODULES:e.LOADING_MODULES.filter((function(e){return!t.data.includes(e)}))});case _e:return Object(G.a)(Object(G.a)({},e),{},{UI_WEBSOCKET_DATA:t.data});case Le:return Object(G.a)(Object(G.a)({},e),{},{UI_WEBSOCKET_READY:t.data});case Fe:return Object(G.a)(Object(G.a)({},e),{},{ROW_EDIT:t.data});case We:return Object(G.a)(Object(G.a)({},e),{},{TYPES_LIST:t.data});case Be:return Object(G.a)(Object(G.a)({},e),{},{GRID_CREATED:t.data});case Ue:return Object(G.a)(Object(G.a)({},e),{},{BASE_MAP_CENTER:t.data});case ke:return console.log("action.data",t.data),Object(G.a)(Object(G.a)({},e),{},{CURRENT_VIEW_OPTION:t.data});default:return e}}var ua=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),da=Object(ra.d)(la,ua),pa=a(514),ja=a(746),ba=a(381);function ha(e,t,a){function n(e){var t=e.toString(16);return 1===t.length?"0"+t:t}return"#"+n(e)+n(t)+n(a)}function fa(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}var Oa=function(e){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/i.test(e)},ma=function(e){var t=e.GEOGRID;if(e.GEOGRIDDATA&&e.GEOGRIDDATA.length===e.GEOGRID.features.length)for(var a=e.GEOGRIDDATA,n=0;n<t.features.length;n++)t.features[n].properties=a[n],t.features[n].properties.id=n;return JSON.parse(JSON.stringify(t))},ga=function(e){for(var t=e.features.map((function(e){return e.geometry.coordinates})),a=e.features.map((function(e){return e.properties})),n=[],r=0;r<t.length;r++)n.push({coordinates:t[r],values:a[r]});return n},va=function(e,t,a){var n=new Set(ot.cityIO.cityIOmodules.filter((function(e){return e.expectUpdate})).map((function(e){return e.name}))),r=new Set(Object.keys(da.getState().CITYIO)),o=Object(Xe.a)(r).filter((function(e){return n.has(e)})),i={method:"post",url:ot.cityIO.baseURL+t+a,data:e,headers:{"Content-Type":"application/json",Accept:"application/json"}};ht()(i).then((function(e){"ok"===e.data.status&&da.dispatch(Ge(o))})).catch((function(e){console.log("ERROR:",e)}))},xa=function(e,t,a,n,r){var o=t.height,i=t.color,c=t.name,s=function(e,t,a){var n=t,r=e.x-n/2,o=e.y-n/2;return a.current.pickObjects({x:r,y:o,width:n,height:n})}(e,n,r);s.forEach((function(e){var t=e.object.properties;t&&t.interactive&&(t.color=Oa(i)?fa(i):i,t.height=o,t.name=c)})),a(s)},ya=new Date;ya.setHours(0,0,0,0);var Sa=function(e,t){t.tz&&ya.setHours(t.tz,0,0,0);var a=new pa.a({color:[255,255,255],intensity:.85}),n=new ja.a({timestamp:0,color:[255,255,255],intensity:1,_shadow:!0}),r=new ba.a({ambientLight:a,dirLight:n});r.shadowColor=[0,0,0,.5],e.current=[r]},Ca=function(e,t){var a=ya.getTime()+1e3*e,n=new Date(a);t.current[0].directionalLights[0].timestamp=Date.UTC(n.getFullYear(),n.getMonth(),n.getDay(),n.getHours(),n.getMinutes(),n.getSeconds())},Da=a(69);function Ta(e){var t=["#85C4C8","#C22E00","#1E96BE","#EC9370","#F6D18A"],a=Object(n.useState)(!1),r=Object(m.a)(a,2),o=r[0],i=r[1],c=function(){var a=[];return e.typeInfo.forEach((function(e,n){a.push({angle:e.proportion,label:JSON.stringify(e.use),color:t[n]})})),a}();return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(Da.g,{colorType:"literal",animation:!0,className:"donut-chart-example",innerRadius:15,radius:25,getLabel:function(e){return e.label},showLabels:!1,getAngle:function(e){return e.angle},data:c,onValueMouseOver:function(e){i(e)},onSeriesMouseOut:function(){return i(!1)},width:50,height:50,padAngle:.1,children:!1!==o&&Object(L.jsx)(Da.e,{value:o,children:Object(L.jsx)("div",{style:{background:"rgba(0,0,0,0.8)",fontSize:10},children:Object(L.jsx)(E.a,{variant:"caption",gutterBottom:!0,children:o.label})})})})})}Object(le.b)((function(e){return{cityioData:e.CITYIO}}),null)((function(e){var t=r.a.useState(null),a=Object(m.a)(t,2),n=a[0],o=a[1],i=Object(le.c)(),c=Object(le.d)((function(e){return e.SELECTED_TYPE})),s=c?c.height:null,l=[{value:0,label:"min"},{value:100,label:"max"}],u=function(e){return"string"==typeof e?JSON.parse(e):e};return Object(L.jsx)(L.Fragment,{children:function(t){var a=[];return Object.keys(t).forEach((function(r,d){var p=t[r].description?t[r].description:null,j=t[r].color,b=u(e.cityioData.GEOGRID.properties.types[r].LBCS),h=u(e.cityioData.GEOGRID.properties.types[r].NAICS);Oa(j)&&(j=fa(j));var f="rgb("+j[0]+","+j[1]+","+j[2]+")",O=n===r,m=!1;t[r].height&&(m=!0),a.push(Object(L.jsxs)("div",{children:[Object(L.jsxs)(k.a,{alignItems:"flex-start",button:!0,variant:"raised",selected:O,onClick:function(e){return a=r,(n=t[r]).name=a,o(a),void i(Ce(n));var a,n},children:[Object(L.jsx)(ea.a,{children:Object(L.jsx)(ta.a,{style:{backgroundColor:f,color:"black"},children:r.charAt(0)})}),Object(L.jsx)(aa.a,{primary:r})]}),Object(L.jsx)(na.a,{in:O,children:Object(L.jsx)(S.a,{spacing:1,p:1,m:1,children:Object(L.jsx)(D.a,{elevation:15,children:Object(L.jsxs)(T.a,{children:[Object(L.jsx)(E.a,{variant:"h5",children:"Type Information"}),p&&Object(L.jsx)(E.a,{variant:"caption",children:p}),Object(L.jsx)(S.a,{spacing:1,p:1,m:1}),Object(L.jsxs)(Ze.a,{container:!0,spacing:3,children:[Object(L.jsx)(Ze.a,{item:!0,xs:6,l:6,md:6,xl:6,container:!0,children:b&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E.a,{variant:"caption",children:"LBCS"}),Object(L.jsx)(Ta,{typeInfo:b})]})}),Object(L.jsx)(Ze.a,{item:!0,xs:6,l:6,md:6,xl:6,container:!0,children:h&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E.a,{variant:"caption",children:"NAICS"}),Object(L.jsx)(Ta,{typeInfo:h})]})}),m&&Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)(Ze.a,{item:!0,xs:10,l:10,md:10,xl:10,container:!0,children:[Object(L.jsx)(E.a,{gutterBottom:!0,children:"Set Height"}),Object(L.jsx)($t.a,{value:s,valueLabelDisplay:"auto",onChange:function(e,t){return i(Ce(Object(G.a)(Object(G.a)({},c),{},{height:t})))},getAriaLabel:function(e){return e.toString()},min:l[0].value,max:l[1].value,marks:l})]})})]})]})})})}),Object(L.jsx)(Vt.a,{})]},Math.random()))})),Object(L.jsx)(C.a,{children:a})}(e.cityioData.GEOGRID.properties.types)})}));var Ia=Object(u.a)({root:{width:"80%",marginLeft:28},subtitle1:{marginTop:12},subtitle2:{marginTop:12}});function Ea(e){var t=e.trips.tripsData,a=t.mode,n=t.profile;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E.a,{variant:"h6",gutterBottom:!0,children:"mode"===e.tripTypeValue?"Mode Choise":"Profiles "}),Object(L.jsx)(Da.c,{height:300,width:150,items:function(e){var t="mode"===e?a:n,r=[];for(var o in t)r.push({title:t[o].name,color:t[o].color});return r}(e.tripTypeValue)})]})}var wa=a(737),Ra=a(443),Ma=a(438),Ga=a(371),Aa=[{value:0,label:"12AM"},{value:21600,label:"6AM"},{value:43200,label:"12PM"},{value:64800,label:"6PM"},{value:86400,label:"12AM"}];var Na=function(e){var t=Ia(),a=Object(le.d)((function(e){return e.SLIDERS})),n=Object(le.c)(),o=r.a.useState("mode"),i=Object(m.a)(o,2),c=i[0],s=i[1];return Object(L.jsxs)("div",{className:t.root,children:[Object(L.jsx)(Ga.a,{component:"fieldset",children:Object(L.jsxs)(Ra.a,{"aria-label":"tripType",name:"tripType",value:c,onChange:function(e){var t;n((t=e.target.value,{type:ge,data:t})),s(e.target.value)},children:[Object(L.jsx)(Ma.a,{value:"mode",control:Object(L.jsx)(wa.a,{}),label:"Mode Choice"}),Object(L.jsx)(Ma.a,{value:"profile",control:Object(L.jsx)(wa.a,{}),label:"Profile"})]})}),Object(L.jsx)(Ea,{trips:e,tripTypeValue:c}),Object(L.jsx)(E.a,{className:t.subtitle1,variant:"subtitle2",id:"range-slider",gutterBottom:!0,children:"Simulation Range"}),Object(L.jsx)($t.a,{min:0,max:86400,marks:Aa,value:a.time,onChange:function(e,t){n(me(Object(G.a)(Object(G.a)({},a),{},{time:t})))},valueLabelDisplay:"off","aria-labelledby":"range-slider"}),Object(L.jsx)(E.a,{className:t.subtitle2,variant:"subtitle2",id:"continuous-slider",gutterBottom:!0,children:"Simulation Speed"}),Object(L.jsx)($t.a,{min:0,max:100,value:a.speed,onChange:function(e,t){n(me(Object(G.a)(Object(G.a)({},a),{},{speed:t})))},valueLabelDisplay:"auto","aria-labelledby":"continuous-slider"})]})},ka=Object(u.a)({root:{width:"80%",marginLeft:28},subtitle1:{marginTop:12},subtitle2:{marginTop:12}});var _a=function(){var e=ka(),t=Object(le.d)((function(e){return e.SLIDERS})),a=Object(le.c)();return Object(L.jsxs)("div",{className:e.root,children:[Object(L.jsx)(E.a,{className:e.subtitle1,variant:"subtitle2",id:"range-slider",gutterBottom:!0,children:"Time of day"}),Object(L.jsx)($t.a,{min:0,max:86400,marks:[{value:0,label:"12AM"},{value:21600,label:"6AM"},{value:43200,label:"12PM"},{value:64800,label:"6PM"},{value:86400,label:"12AM"}],value:t.time,onChange:function(e,n){a(me(Object(G.a)(Object(G.a)({},t),{},{time:n})))},valueLabelDisplay:"off","aria-labelledby":"range-slider"})]})},La=a(710),Ba=a(715);var Pa=function(e){var t=Object(le.d)((function(e){return e.ACCESS_TOGGLE})),a=e.cityioData,n=a&&a.access&&a.access.properties?a.access.properties:[],r=Object(le.c)(),o=ot.map.layers.heatmap.colors,i=o.length-1;return Object(L.jsxs)(C.a,{children:[Object(L.jsx)(k.a,{children:Object(L.jsx)(Da.b,{width:500,startColor:"rgb("+o[0][0]+","+o[0][1]+","+o[0][2]+")",endColor:"rgb("+o[i][0]+","+o[i][1]+","+o[i][2]+")",startTitle:"No Access",endTitle:"Full Access"})}),n.map((function(e,a){return Object(L.jsxs)(k.a,{children:[Object(L.jsx)(aa.a,{primary:e,style:{textTransform:"capitalize"}}),Object(L.jsx)(La.a,{children:Object(L.jsx)(Ba.a,{edge:"end",checked:t===a,onChange:function(){r({type:ve,data:a})}})})]},e)}))]})};var Fa=function(e){for(var t=e.handleToggle,a=Object(le.d)((function(e){return{menuState:e.MENU,cityioData:e.CITYIO}})),n=a.menuState,r=a.cityioData,o=ot.menu.toggles,i=Object.keys(o),c=[],s=Object.keys(r),l=0;l<i.length;l++){var u=o[i[l]].requireModule,d=!!n.includes(i[l]);if(s.includes(u)||!1===u){var p=Object(L.jsxs)("div",{children:[Object(L.jsxs)(k.a,{children:[Object(L.jsx)(Ba.a,{edge:"start",onChange:t(i[l]),checked:d}),Object(L.jsx)(aa.a,{primary:o[i[l]].displayName})]}),"SHADOWS"===i[l]&&Object(L.jsx)(na.a,{in:d,children:Object(L.jsx)(_a,{})}),"ABM"===i[l]&&Object(L.jsx)(na.a,{in:d,children:Object(L.jsx)(Na,{tripsData:r.ABM2.attr})}),"ACCESS"===i[l]&&Object(L.jsx)(na.a,{in:d,style:{marginLeft:24},children:Object(L.jsx)(Pa,{cityioData:r})})]},i[l]);c.push(p)}}return Object(L.jsx)(C.a,{children:c})};a(699),a(704),a(702),a(703),a(701);a(521);var za=a(522),Wa=a.n(za),Ua=a(714),Ya=a(712),Ha=a(713),Va=a(676),Ja=a(437),Ka=function(){var e=Object(Et.a)(It.a.mark((function e(t){var a;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();var Xa=function(e){var t=e.chosenScenario,a=e.displayUI,r=Object(n.useState)("scenario1"),o=Object(m.a)(r,2),i=(o[0],o[1],Object(n.useState)(!1)),c=Object(m.a)(i,2),s=c[0],l=c[1];Object(n.useEffect)((function(){function e(){return(e=Object(Et.a)(It.a.mark((function e(){return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]);var u=Object(n.useState)({}),d=Object(m.a)(u,2),p=d[0],j=d[1],b=Object(le.d)((function(e){return e.CITYIO})),h=Object(le.c)(),f=Object(n.useState)(0),O=Object(m.a)(f,2),g=O[0],v=O[1],x=["2021","2030"];function y(e){return S.apply(this,arguments)}function S(){return(S=Object(Et.a)(It.a.mark((function e(t){var a,n,r,o,i,c,s;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(ot.cityIO.baseURL).concat(t,"/"),e.next=3,Ka(a+"meta/hashes/");case 3:return n=e.sent,r=[],o=[],(i=ot.cityIO.cityIOmodules.map((function(e){return e.name}))).forEach((function(e){p[e]!==n[e]?(r.push(Ka("".concat(a).concat(e,"/"))),o.push(e)):r.push(null)})),h(Ge(o)),e.next=11,Promise.all(r);case 11:c=e.sent,j(n),(s=i.reduce((function(e,t,a){return c[a]?(console.log("updating ".concat(t)),Object(G.a)(Object(G.a)({},e),{},Object(et.a)({},t,c[a]))):e}),b)).tableName=t,h(Ne(o)),h(he(s)),console.log("done updating from cityIO"),h(Te(!0)),h(Ee(!1));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(L.jsxs)(L.Fragment,{children:[a&&Object(L.jsx)(Ua.a,{alternativeLabel:!0,nonLinear:!0,activeStep:g,children:x.map((function(e,t){return Object(L.jsx)(Ya.a,{children:Object(L.jsx)(Ha.a,{onClick:(a=t,Object(Et.a)(It.a.mark((function e(){var t;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v(a),t=null,e.t0=a,e.next=0===e.t0?5:1===e.t0?7:9;break;case 5:return t="hcm_test_v1",e.abrupt("break",9);case 7:return t="hcm_test_v2",e.abrupt("break",9);case 9:return l(!0),e.next=12,y(t);case 12:l(!1);case 13:case"end":return e.stop()}}),e)})))),icon:"\u2022",disabled:s,children:Object(L.jsx)(Va.a,{children:e})})},e);var a}))}),s&&Object(L.jsx)(Ja.a,{})]})},qa=function(){var e=Object(Et.a)(It.a.mark((function e(t){var a;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();var Qa=function(e){var t=e.tableName,a=Object(le.d)((function(e){return e.MENU})),r=Object(le.d)((function(e){return e.CITYIO})),o=Object.keys(r),i=ot.menu.toggles,c=Object(le.c)(),s=function(e){return function(){var t=a.indexOf(e),n=Object(Xe.a)(a);-1===t?n.push(e):n.splice(t,1),c(ye(n))}},l=Object(Xe.a)(a),u=Object(n.useState)("hcm_test_v1"),d=Object(m.a)(u,2),p=d[0],j=d[1],b="hcm_test_v1";function h(){return f.apply(this,arguments)}function f(){return(f=Object(Et.a)(It.a.mark((function e(){var a,n,r,s,u,d,p,f;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qa("".concat("https://cs-map.vlab.tech/api","/get-option"));case 2:return a=e.sent,e.next=5,qa("".concat("https://cs-map.vlab.tech/api","/get-scenario"));case 5:n=e.sent,a&&(console.log(a),r=a.table,s=a.option,u=a.mode,r==t&&s&&(d=i[s].requireModule,(o.includes(d)||!1===d)&&(p=l.indexOf(s),"ON"==u?-1===p&&l.push(s):-1!==p&&l.splice(p,1),c(ye(l))))),n&&(console.log(n),(f=n.scenario)&&f!=b&&(b=f,j(f))),setTimeout(h,1e3);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var e=setTimeout(h,1e3);return function(){return clearTimeout(e)}}),[]),Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(C.a,{children:[Object(L.jsx)(k.a,{children:Object(L.jsx)(E.a,{variant:"h2",children:"View Options"})}),Object(L.jsx)(k.a,{children:Object(L.jsx)(_.a,{startIcon:Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Wa.a,{}),"RESET VIEW"]}),color:"default",onClick:s("RESET_VIEW")})})]}),Object(L.jsx)(Fa,{handleToggle:s}),Object(L.jsx)(Xa,{chosenScenario:p,displayUI:!0})]})},Za=a(523),$a=a.n(Za),en=function(e){if(!e.mousePos||!e.hoveredCells)return null;var t=e.selectedType,a=e.hoveredCells.object.properties.interactive,n=e.mousePos,r=e.divSize,o=t.color;Oa(o)&&(o=fa(o));var i="rgb("+o[0]+","+o[1]+","+o[2]+")",c="rgba("+o[0]+","+o[1]+","+o[2]+",0.6)",s=n.clientX-r/2,l=n.clientY-r/2,u=a?t.name:"Not-interactive";return Object(L.jsx)("div",{style:{border:"2px solid",backgroundColor:e.mouseDown?c:"rgba(0,0,0,0)",borderColor:i,color:i,borderRadius:"15%",position:"fixed",zIndex:10,pointerEvents:"none",width:r,height:r,left:s,top:l},children:Object(L.jsxs)("div",{style:{position:"relative",left:r+10,fontSize:"0.8em"},children:[!a&&Object(L.jsx)($a.a,{}),u,":"]})})},tn=function(e){if(!e.mousePos)return null;var t=e.mousePos;return Object(L.jsxs)("div",{style:{borderRadius:"10%",position:"fixed",pointerEvents:"none",backgroundColor:"rgba(0,0,0,0.5)",padding:"1vw",color:"rgba(255,255,255,0.9)",zIndex:10,left:t.clientX,top:t.clientY,fontFamily:"monospace",fontSize:"0.65em",fontWeight:500},children:[Object(L.jsxs)("p",{children:["Type:",e.hoveredObj.object.properties.name]}),Object(L.jsxs)("p",{children:["Floors:",e.hoveredObj.object.properties.height]}),Object(L.jsxs)("p",{children:["ID:",e.hoveredObj.object.properties.id]})]})};function an(e){var t=e.editOn,a=e.mousePos,n=e.selectedType,r=e.pickingRadius,o=e.mouseDown,i=e.hoveredObj;return t?n&&Object(L.jsx)(en,{mousePos:a,selectedType:n,divSize:r,mouseDown:o,hoveredCells:i}):i&&Object(L.jsx)(tn,{mousePos:a,hoveredObj:i})}var nn=function(e){Object(ie.a)(a,e);var t=Object(ce.a)(a);function a(e){var n;return Object(re.a)(this,a),(n=t.call(this,e)).animationFrame=null,n}return Object(oe.a)(a,[{key:"componentWillUnmount",value:function(){this.animationFrame&&window.cancelAnimationFrame(this.animationFrame)}},{key:"componentDidMount",value:function(){this._animate()}},{key:"_animate",value:function(){var e=this.props,t=e.toggles,a=t.rotateOn,n=t.ABMOn,r=e.state,o=r.viewState,i=r.sliders,c=e.updaters,s=c.listenToSlidersEvents,l=c.sunEffects,u=c.setViewState,d=e.dispatch;if(a){var p=o.bearing?o.bearing:0;p<360?p+=.05:p=0,u(Object(G.a)(Object(G.a)({},o),{},{bearing:p}))}if(n){var j=i.time[1],b=i.speed,h=i.time[0],f=i.time[2],O=parseInt(j)+parseInt(b);(j<h||j>f)&&(O=h),d(s(Object(G.a)(Object(G.a)({},i),{},{time:[i.time[0],O,i.time[2]]}))),l&&l.updateSunDirection(O)}this.animationFrame=window.requestAnimationFrame(this._animate.bind(this))}},{key:"render",value:function(){return null}}]),a}(n.Component),rn=a(731);function on(e){var t=e.data,a=(e.cellSize,Object(le.d)((function(e){return[e.ACCESS_TOGGLE]})));return new rn.a({id:"ACCESS",colorRange:ot.map.layers.heatmap.colors,radiusPixels:200,opacity:.5,threshold:.5,data:t,getPosition:function(e){return e.coordinates},getWeight:function(e){return e.values[a]},updateTriggers:{getWeight:[a]}})}var cn=a(326);function sn(e){var t=e.data,a=e.cityioData,n=e.ABMmode;return new cn.a({id:"AGGREGATED_TRIPS",shadowEnabled:!1,data:t,getPath:function(e){var t=Math.random()<.5?5e-5*Math.random():-5e-5*Math.random();for(var a in e.path)e.path[a][0]=e.path[a][0]+t,e.path[a][1]=e.path[a][1]+t,e.path[a][2]=2*e.mode[0];return e.path},getColor:function(e){return fa(a.ABM2.attr[n][e[n]].color)},opacity:.2,getWidth:1.5,updateTriggers:{getColor:n},transitions:{getColor:500}})}var ln=a(726);function un(e){var t,a=e.data,n=e.cityioData,r=e.ABMmode,o=e.zoomLevel,i=e.sliders;return new ln.a({id:"ABM",data:a,getPath:function(e){return e.path},getTimestamps:function(e){return e.timestamps},getColor:function(e){return fa(n.ABM2.attr[r][e[r]].color)},shadowEnabled:!1,getWidth:1,widthScale:(t=o,t>15&&t<25?3:t<15&&t>10?12:30),opacity:.8,rounded:!0,trailLength:500,currentTime:i.time[1],updateTriggers:{getColor:r},transitions:{getColor:500}})}function dn(e){var t=e.data,a=e.editOn,n=e.state,r=n.selectedType,o=n.keyDownState,i=n.selectedCellsState,c=n.pickingRadius,s=e.updaters,l=s.setSelectedCellsState,u=s.setDraggingWhileEditing,d=s.setHoveredObj,p=e.deckGL;return new pe.a({id:"GRID",data:t,pickable:!0,extruded:!0,wireframe:!0,lineWidthScale:1,lineWidthMinPixels:2,getElevation:function(e){return e.properties.height},getFillColor:function(e){return e.properties.color},onClick:function(e){r&&a&&"Shift"!==o&&xa(e,r,l,c,p)},onDrag:function(e){r&&a&&"Shift"!==o&&xa(e,r,l,c,p)},onDragStart:function(){r&&a&&"Shift"!==o&&u(!0)},onHover:function(e){e.object&&d(e)},onDragEnd:function(){u(!1)},updateTriggers:{getFillColor:i,getElevation:i},transitions:{getFillColor:500,getElevation:500}})}function pn(e){var t=e.data,a=e.coordinates;if(t&&a&&a.features){var n=[];return t.forEach((function(e){n.push({coordinates:[a.features[e.id].geometry.coordinates[0][0][0],a.features[e.id].geometry.coordinates[0][0][1],100],info:e.info})})),new Ft.a({id:"text-layer",data:n,pickable:!0,getPosition:function(e){return e.coordinates},getText:function(e){return e.info},getColor:[255,255,255],getSize:30,getAngle:0,getTextAnchor:"middle",getAlignmentBaseline:"center"})}}function jn(e){var t=e.data;return new pe.a({id:"GeojsonLayer",data:t,pickable:!0,wireframe:!0,stroked:!1,filled:!0,extruded:!0,lineWidthScale:1,getFillColor:function(e){return fa(e.properties.fill)},getLineColor:function(e){return fa(e.properties.stroke)},lineWidthMinPixels:2,getElevation:function(e){return e.properties.height}})}function bn(e){var t,a,r=e.pitchMap,o=e.zoomMap,i=e.autoRotate,c=e.onlyMap,s=Object(n.useState)(!1),l=Object(m.a)(s,2),u=l[0],d=l[1],p=Object(n.useState)(null),j=Object(m.a)(p,2),b=j[0],h=j[1],f=Object(n.useState)(ot.map.initialViewState),O=Object(m.a)(f,2),g=O[0],v=O[1],x=Object(n.useState)(null),y=Object(m.a)(x,2),S=y[0],C=y[1],D=Object(n.useState)(null),T=Object(m.a)(D,2),I=T[0],E=T[1],w=Object(n.useState)(null),R=Object(m.a)(w,2),M=R[0],A=R[1],N=Object(n.useState)(null),k=Object(m.a)(N,2),_=k[0],B=k[1],P=Object(n.useState)(null),F=Object(m.a)(P,2),z=F[0],W=F[1],U=Object(n.useState)(null),Y=Object(m.a)(U,2),H=Y[0],V=Y[1],J=Object(n.useState)(null),K=Object(m.a)(J,2),X=K[0],q=K[1],Q=Object(n.useState)(null),Z=Object(m.a)(Q,2),$=Z[0],ee=Z[1],te=Object(n.useState)({}),ae=Object(m.a)(te,2),ne=ae[0],re=ae[1],oe=Object(n.useState)(!1),ie=Object(m.a)(oe,2),ce=ie[0],se=ie[1],pe=Object(n.useRef)(),je=Object(n.useRef)(),be=Object(le.c)(),he=Object(le.d)((function(e){return[e.CITYIO,e.SLIDERS,e.MENU,e.SELECTED_TYPE,e.ABM_MODE]})),fe=Object(m.a)(he,5),Oe=fe[0],ge=fe[1],ve=fe[2],xe=fe[3],ye=fe[4],Se=ve.includes("ABM");if(i)var Ce=i;else Ce=ve.includes("ROTATE");var De=ve.includes("SHADOWS"),Te=ve.includes("EDIT"),Ie=ve.includes("RESET_VIEW");Object(n.useEffect)((function(){console.log(9283),we(),Sa(pe,Oe.GEOGRID.properties.header),Ee(),se(!0)}),[]),Object(n.useEffect)((function(){ce&&Ca(ge.time[1],pe)}),[ge.time]),Object(n.useEffect)((function(){if(ce){var e=De?[0,0,0,.5]:[0,0,0,0];pe.current[0].shadowColor=e}}),[De]),Object(n.useEffect)((function(){ee(ma(Oe)),Oe.access&&W(ga(Oe.access)),Oe.textual&&V(Oe.textual),Oe.geojson&&q(Oe.geojson),Oe.ABM2&&re(Oe.ABM2)}),[Oe]),Object(n.useEffect)((function(){if(ce&&!Te){for(var e=[],t=0;t<$.features.length;t++)e[t]=$.features[t].properties;va(e,Oe.tableName,"/GEOGRIDDATA")}}),[Te]),Object(n.useEffect)((function(){ce&&Ee()}),[Ie]);var Ee=function(){var e=Oe.GEOGRID.properties.header;v(Object(G.a)(Object(G.a)({},g),{},{longitude:e.longitude,latitude:e.latitude,zoom:null!==o&&void 0!==o?o:14,pitch:null!==r&&void 0!==r?r:0,bearing:360-e.rotation,orthographic:!0}))},we=function(){document.getElementById("deckgl-wrapper").addEventListener("contextmenu",(function(e){return e.preventDefault()}))},Re={ABM:un({data:ne.trips,cityioData:Oe,ABMmode:ye,zoomLevel:g.zoom,sliders:ge}),AGGREGATED_TRIPS:sn({data:ne.trips,cityioData:Oe,ABMmode:ye}),GRID:dn({data:$,editOn:ve.includes("EDIT"),state:{selectedType:xe,keyDownState:S,selectedCellsState:b,pickingRadius:40},updaters:{setSelectedCellsState:h,setDraggingWhileEditing:d,setHoveredObj:B},deckGL:je}),ACCESS:on({data:z,cellSize:null===(t=Oe.GEOGRID)||void 0===t||null===(a=t.properties)||void 0===a?void 0:a.header.cellSize}),TEXTUAL:pn({data:H&&H,coordinates:$}),GEOJSON:jn({data:X&&X})},Me=["TEXTUAL","ABM","AGGREGATED_TRIPS","GEOJSON","GRID","ACCESS"];return Object(L.jsxs)("div",{className:"baseMap",onKeyDown:function(e){C(e.nativeEvent.key)},onKeyUp:function(){return C(null)},onMouseMove:function(e){return E(e.nativeEvent)},onMouseUp:function(){return A(!1)},onMouseDown:function(){return A(!0)},children:[Object(L.jsx)(an,{editOn:Te,mousePos:I,selectedType:xe,pickingRadius:40,mouseDown:M,hoveredObj:_}),Object(L.jsx)(nn,{toggles:{ABMOn:Se,rotateOn:Ce},state:{sliders:ge,viewState:g},updaters:{listenToSlidersEvents:me,updateSunDirection:Ca,setViewState:v},dispatch:be}),Object(L.jsx)(de.a,{ref:je,viewState:g,onViewStateChange:function(e){var t=e.viewState;v(t)},layers:function(){var e,t=[],a=Object(wt.a)(Me);try{for(a.s();!(e=a.n()).done;){var n=e.value;ve.includes(n)&&t.push(Re[n])}}catch(r){a.e(r)}finally{a.f()}return t}(),effects:pe.current,controller:{touchZoom:!c,touchRotate:!c,scrollZoom:!c,dragPan:!c&&!u,dragRotate:!c&&!u,keyboard:!1},children:Object(L.jsx)(ue.a,{asyncRender:!1,dragRotate:!0,reuseMaps:!0,mapboxApiAccessToken:"pk.eyJ1IjoidmxhYi1jb21wYW55IiwiYSI6ImNrZHM3aXc0ZDE0bXUzM2p6OG1zNzJmYWEifQ.MKr7Fn4bDrTQiCEwJcuo1A",mapStyle:i?"":ot.map.mapStyle.sat,preventStyleDiffing:!0})})]})}a(367),a(660);var hn=300,fn=["#ff5278","#660016"];function On(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)((function(){if(console.log("props radar",e),e&&e.cityioData&&e.cityioData.indicators&&e.cityioData.indicators.length>0){console.log(121);var t=function(e){for(var t={},a={},n=[],r=0;r<e.length;r++)"radar"===e[r].viz_type&&(t[e[r].name]=[e[r].value],a[e[r].name]=[e[r].ref_value],e[r].domain=[0,1],n.push(e[r]));return{radarData:[t,a],domains:n}}(e.cityioData.indicators);o(t)}}),[e]),Object(L.jsx)("div",{children:r&&r.domains?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Da.f,{className:"Radar blur",animation:!0,data:r.radarData,domains:r.domains,colorRange:fn,style:{polygons:{fillOpacity:.2,strokeWidth:2},axes:{text:{opacity:0,fontWeight:700,fill:"white",fontFamily:"Roboto Mono"},strokeWidth:0},labels:{fontFamily:"Roboto Mono",textAnchor:"middle",fontSize:10,fill:"white"}},margin:{left:50,top:50,bottom:50,right:50},width:hn,height:hn,children:Object(L.jsx)(Da.a,{style:{fill:"white",fillOpacity:.1,backgroundColor:"#FFF",opacity:.5,stroke:"white",width:.1},tickValues:Object(Xe.a)(new Array(11)).map((function(e,t){return t/10-1}))})}),Object(L.jsx)(Da.c,{items:["Design","Reference"],colors:fn,style:{fontFamily:"Roboto Mono"}})]}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(Da.f,{className:"Radar blur",animation:!0,data:[],domains:[],colorRange:fn,style:{polygons:{fillOpacity:.2,strokeWidth:2},axes:{text:{opacity:0,fontWeight:700,fill:"white",fontFamily:"Roboto Mono"},strokeWidth:0},labels:{fontFamily:"Roboto Mono",textAnchor:"middle",fontSize:10,fill:"white"}},margin:{left:50,top:50,bottom:50,right:50},width:hn,height:hn,children:Object(L.jsx)(Da.a,{style:{fill:"white",fillOpacity:.1,backgroundColor:"#FFF",opacity:.5,stroke:"white",width:.1},tickValues:Object(Xe.a)(new Array(11)).map((function(e,t){return t/10-1}))})}),Object(L.jsx)(Da.c,{items:["Design","Reference"],colors:fn,style:{fontFamily:"Roboto Mono"}})]})})}function mn(e){var t=Object(n.useState)([{x:0,y:0},{x:0,y:0},{x:0,y:0}]),a=Object(m.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(null),c=Object(m.a)(i,2),s=c[0],l=c[1];Object(n.useEffect)((function(){if(e&&e.cityioData&&e.cityioData.indicators&&e.cityioData.indicators.length>0){var t=u(e.cityioData.indicators);o(t.barChartData)}}),[e]);var u=function(e){for(var t=[],a=0;a<e.length;a++)"bar"===e[a].viz_type&&t.push({x:e[a].name,y:e[a].value});return{barChartData:t}};return Object(L.jsx)(L.Fragment,{children:r&&Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)(S.a,{flexDirection:"column",children:[Object(L.jsx)(S.a,{alignContent:"center",p:3,children:Object(L.jsxs)(Da.d,{opacity:.2,xType:"ordinal",width:250,height:250,stackBy:"y",yDomain:[0,1],children:[Object(L.jsx)(Da.i,{style:{text:{fill:"#FFF",fontFamily:"Roboto Mono"}},tickLabelAngle:90}),Object(L.jsx)(Da.j,{style:{text:{fill:"#FFF"}}}),Object(L.jsx)(Da.h,{animation:!0,onValueMouseOver:function(e){l(e)},data:r})]})}),Object(L.jsx)(S.a,{alignContent:"center",children:s&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E.a,{variant:"caption",gutterBottom:!0,children:s.x}),Object(L.jsx)(S.a,{m:3}),Object(L.jsx)(E.a,{gutterBottom:!0,children:s.y})]})})]})})})}function gn(e){var t,a,r=250,o=Object(n.useState)(!1),i=Object(m.a)(o,2),c=i[0],s=i[1],l=Object(n.useState)(null),u=Object(m.a)(l,2),d=u[0],p=u[1],j=null===(t=e.cityioData.GEOGRID)||void 0===t||null===(a=t.properties)||void 0===a?void 0:a.header;return Object(n.useEffect)((function(){var t;t=j.tableName&&j.tableName.includes("hcm_")?function(){e.cityioData.GEOGRID.properties.header.cellSize;var t=e.cityioData.GEOGRIDDATA,a={};t.forEach((function(e){var t=e.LandUseTyp,n=e.TypeCode,r=e.RGB.split(","),o=Math.round(100*e.ShapeArea)/100;"None"!==e.TypeCode&&(a.hasOwnProperty(n)?a[n].area=a[n].area+o:(a[n]={},a[n].area=o,a[n].name=t,a[n].color=ha(parseInt(r[0]),parseInt(r[1]),parseInt(r[2]))))}));var n=[];for(var r in a)n.push(a[r]);return{children:n,color:1}}():function(){var t=e.cityioData.GEOGRID.properties.header.cellSize,a=e.cityioData.GEOGRIDDATA,n={};a.forEach((function(e){var a=e.name;if("None"!==e.name)if(n.hasOwnProperty(a)){n[a].count=n[a].count+1;var r=e.height<1?1:e.height;n[a].area=n[a].area+r*t}else n[a]={},n[a].area=0,n[a].count=0,n[a].name=a,n[a].color=ha(e.color[0],e.color[1],e.color[2])}));var r=[];for(var o in n)r.push(n[o]);var i={children:r,color:1};return console.log("radialData",r),i}(),p(t)}),[e]),Object(L.jsxs)(C.a,{children:[d&&d.children&&Object(L.jsx)(k.a,{alignItems:"center",children:Object(L.jsx)(Da.g,{colorType:"literal",animation:!0,className:"donut-chart-example",innerRadius:75,radius:125,getLabel:function(e){return e.name},labelsRadiusMultiplier:.95,labelsStyle:{textAnchor:"middle",font:"sans-serif",fontSize:11,fill:"#FFF",textShadow:"2px 2px 2px #000",fontFamily:"Roboto Mono"},showLabels:!0,getAngle:function(e){return e.area},data:d.children,onValueMouseOver:function(e){return s(e)},onSeriesMouseOut:function(){return s(!1)},width:r,height:r,padAngle:.01,children:!1!==c&&Object(L.jsx)(Da.e,{value:c,children:Object(L.jsx)("div",{style:{background:"rgba(0,0,0,0.8)",fontSize:14},children:Object(L.jsxs)(E.a,{variant:"caption",gutterBottom:!0,children:["Area: ",c.area," sqm"]})})})})}),c.name&&Object(L.jsxs)(C.a,{children:[Object(L.jsx)(k.a,{children:Object(L.jsx)(E.a,{variant:"caption",children:c.name})}),Object(L.jsx)(k.a,{children:Object(L.jsxs)(E.a,{children:[c.area," sqm"]})})]})]})}var vn=function(e){return Object(L.jsx)(L.Fragment,{children:e.cityIOdata&&Object(L.jsxs)(C.a,{children:[Object(L.jsx)(k.a,{style:{justifyContent:"center"},children:Object(L.jsx)(gn,{cityioData:e.cityIOdata})}),Object(L.jsx)(Vt.a,{}),Object(L.jsx)(k.a,{style:{justifyContent:"center"},children:Object(L.jsx)(On,{cityioData:e.cityIOdata})}),Object(L.jsx)(Vt.a,{}),Object(L.jsx)(k.a,{style:{justifyContent:"center"},children:Object(L.jsx)(mn,{cityioData:e.cityIOdata})})]})})},xn=Object(u.a)((function(e){return{root:{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)}}}));function yn(e){var t=xn(),a=e.tableName,n=e.cityIOdata;return Object(L.jsxs)(te,{className:t.root,title:"CitySCopeJS",children:[Object(L.jsx)(Zt,{}),Object(L.jsx)($.a,{maxWidth:null,children:Object(L.jsxs)(Ze.a,{container:!0,spacing:5,children:[Object(L.jsx)(Ze.a,{item:!0,xs:6,l:3,md:3,xl:2,container:!0,children:Object(L.jsx)(Ze.a,{item:!0,container:!0,direction:"column",spacing:2,children:Object(L.jsx)(Ze.a,{item:!0,xs:12,l:12,md:12,xl:12,children:Object(L.jsx)(D.a,{elevation:15,style:{maxHeight:"85vh",overflow:"auto"},children:Object(L.jsx)(T.a,{children:Object(L.jsx)(Qa,{tableName:a})})})})})}),Object(L.jsx)(Ze.a,{item:!0,xs:6,l:6,md:6,xl:8,children:Object(L.jsx)(D.a,{elevation:15,style:{height:"85vh",width:"100%",position:"relative"},children:Object(L.jsx)(bn,{})})}),Object(L.jsx)(Ze.a,{item:!0,xs:6,l:3,md:3,xl:2,children:Object(L.jsx)(D.a,{elevation:15,style:{maxHeight:"85vh",overflow:"auto"},children:Object(L.jsx)(vn,{cityIOdata:n})})})]})})]})}function Sn(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),c=i[0],s=i[1];Object(n.useEffect)((function(){var e=window.location.toString(),t="cityscope=",a=e.substring(e.indexOf(t)+t.length).toLowerCase();-1!==e.indexOf(t)&&a.length>0?r(a):s(!0)}),[]);var l=Object(le.d)((function(e){return e.READY})),u=Object(le.d)((function(e){return e.CITYIO}));return Object(L.jsxs)(L.Fragment,{children:[a&&Object(L.jsx)(At,{tableName:a}),l&&Object(L.jsx)(yn,{cityIOdata:u,tableName:a}),c&&Object(L.jsx)(qt,{}),Object(L.jsx)(Zt,{})]})}var Cn=function(){var e=Object(Et.a)(It.a.mark((function e(t){var a;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();function Dn(e){var t=e.tableName,a=Object(n.useState)(null),r=Object(m.a)(a,2),o=r[0],i=r[1],c=Object(n.useState)({}),s=Object(m.a)(c,2),l=s[0],u=s[1],d="".concat(ot.cityIO.baseURL).concat(t,"/"),p=Object(le.d)((function(e){return e.CITYIO})),j=Object(le.c)();function b(){return h.apply(this,arguments)}function h(){return(h=Object(Et.a)(It.a.mark((function e(){var t;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn(d+"/meta/id/");case 2:t=e.sent,o!==t&&i(t),setTimeout(b,ot.cityIO.interval);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=Object(Et.a)(It.a.mark((function e(){var a,n,r,o,i,c;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn(d+"/meta/hashes/");case 2:return a=e.sent,n=[],r=[],(o=ot.cityIO.cityIOmodules.map((function(e){return e.name}))).forEach((function(e){l[e]!==a[e]?(n.push(Cn("".concat(d,"/").concat(e,"/"))),r.push(e)):n.push(null)})),j(Ge(r)),e.next=10,Promise.all(n);case 10:i=e.sent,u(a),(c=o.reduce((function(e,t,a){return i[a]?(console.log("updating ".concat(t)),Object(G.a)(Object(G.a)({},e),{},Object(et.a)({},t,i[a]))):e}),p)).tableName=t,j(Ne(r)),j(he(c)),console.log("done updating from cityIO"),j(Te(!0)),j(Ee(!1));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var e=setTimeout(b,ot.cityIO.interval);return console.log("reading cityIO every -> "+ot.cityIO.interval+"ms"),function(){return clearTimeout(e)}}),[]),Object(n.useEffect)((function(){o&&(j(Ee(!0)),function(){f.apply(this,arguments)}())}),[o]),null}function Tn(e){var t=e.active,a=e.data,n=e.accessToggle;return new rn.a({visible:t,id:"ACCESS",colorRange:ot.map.layers.heatmap.colors,radiusPixels:200,opacity:.5,threshold:.5,data:a,getPosition:function(e){return e.coordinates},getWeight:function(e){return e.values[n]},updateTriggers:{getWeight:[n]}})}function In(e){var t=e.active,a=e.data,n=e.cityioData,r=e.ABMmode;return new cn.a({visible:t,id:"AGGREGATED_TRIPS",_shadow:!1,data:a,getPath:function(e){var t=Math.random()<.5?5e-5*Math.random():-5e-5*Math.random();for(var a in e.path)e.path[a][0]=e.path[a][0]+t,e.path[a][1]=e.path[a][1]+t,e.path[a][2]=2*e.mode[0];return e.path},getColor:function(e){return fa(n.ABM2.attr[r][e[r]].color)},opacity:.2,getWidth:1.5,updateTriggers:{getColor:r},transitions:{getColor:500}})}function En(e){var t,a=e.active,n=e.data,r=e.cityioData,o=e.ABMmode,i=e.zoomLevel,c=e.time;return new ln.a({id:"ABM",data:n,getPath:function(e){return e.path},getTimestamps:function(e){return e.timestamps},getColor:function(e){return fa(r.ABM2.attr[o][e[o]].color)},visible:a,getWidth:1,widthScale:(t=i,t>15&&t<25?3:t<15&&t>10?12:30),opacity:.8,rounded:!0,trailLength:500,currentTime:c,updateTriggers:{getColor:o},transitions:{getColor:500}})}function wn(e){var t=e.active,a=e.data;return new pe.a({visible:t,id:"GRID",data:a,extruded:!0,wireframe:!0,lineWidthScale:1,lineWidthMinPixels:2,getElevation:function(e){return e.properties.height},getFillColor:function(e){return e.properties.color},transitions:{getFillColor:500,getElevation:500}})}function Rn(e){var t=Object(n.useState)(ot.map.initialViewState),a=Object(m.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(null),c=Object(m.a)(i,2),s=c[0],l=c[1],u=Object(n.useState)(null),d=Object(m.a)(u,2),p=d[0],j=d[1],b=Object(n.useState)({}),h=Object(m.a)(b,2),f=h[0],O=h[1],g=Object(n.useRef)(),v=Object(n.useRef)(),x=Object(le.d)((function(e){return[e.CITYIO]})),y=Object(m.a)(x,1)[0],S=Object(le.d)((function(e){return e.UI_WEBSOCKET_DATA}));Object(n.useEffect)((function(){g.current&&Ca(e.viewSettings.time,g)}),[e.viewSettings]);Object(n.useEffect)((function(){if(C(),Sa(g,y.GEOGRID.properties.header),localStorage.getItem("deckGLviewState")){console.log("loading prev. deckGLviewState...");var e=localStorage.getItem("deckGLviewState");o(JSON.parse(e))}else!function(){var e=y.GEOGRID.properties.header;o(Object(G.a)(Object(G.a)({},r),{},{longitude:e.longitude,latitude:e.latitude,zoom:15,pitch:0,bearing:360-e.rotation,orthographic:!0}))}();g.current[0].shadowColor=[0,0,0,1]}),[y.GEOGRID.properties.header]),Object(n.useEffect)((function(){j(ma(y)),y.access&&l(ga(y)),y.ABM2&&O(y.ABM2)}),[y]);var C=function(){document.getElementById("deckgl-wrapper").addEventListener("contextmenu",(function(e){return e.preventDefault()}))},D={ABM:En({active:S.ABMLayer.active,data:f.trips,cityioData:y,ABMmode:S.ABMLayer.ABMmode,zoomLevel:S.ABMLayer.zoomLevel,time:S.time}),AGGREGATED_TRIPS:In({active:S.AggregatedTripsLayer.active,data:f.trips,cityioData:y,ABMmode:S.AggregatedTripsLayer.ABMmode}),GRID:wn({active:S.GridLayer.active,data:p}),ACCESS:Tn({active:S.AccessLayer.active,data:s,accessToggle:S.AccessLayer.accessToggle})},T=["ABM","AGGREGATED_TRIPS","GRID","ACCESS"];return Object(L.jsx)(de.a,{ref:v,viewState:r,onViewStateChange:function(e){var t=e.viewState;localStorage.setItem("deckGLviewState",JSON.stringify(t)),o(t)},layers:function(){var e,t=[],a=Object(wt.a)(T);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(D[n])}}catch(r){a.e(r)}finally{a.f()}return t}(),effects:g.current,controller:{keyboard:!1},children:Object(L.jsx)(ue.a,{asyncRender:!1,dragRotate:!0,reuseMaps:!0,mapboxApiAccessToken:"pk.eyJ1IjoidmxhYi1jb21wYW55IiwiYSI6ImNrZHM3aXc0ZDE0bXUzM2p6OG1zNzJmYWEifQ.MKr7Fn4bDrTQiCEwJcuo1A",mapStyle:ot.map.mapStyle.sat,preventStyleDiffing:!0})})}var Mn=a(661).solve,Gn=function(e,t){for(var a=[],n=[],r=0,o=e.length;r<o;++r){var i=Object(m.a)(e[r],2),c=i[0],s=i[1],l=Object(m.a)(t[r],2),u=l[0],d=l[1];a.push([c,s,1,0,0,0,-c*u,-s*u],[0,0,0,c,s,1,-c*d,-s*d]),n.push(u,d)}var p=Mn(a,n,!0);return[p[0],p[3],0,p[6],p[1],p[4],0,p[7],0,0,1,0,p[2],p[5],0,1].map((function(e){return function(e,t){var a=Math.pow(10,t),n=e*a;return Math.round(n)/a}(e,10)}))},An=function(e){return"matrix3d(".concat(e.join(", "),")")},Nn=function(e){return"translate(".concat(e[0],"px, ").concat(e[1],"px)")},kn=20/1.5,_n={container:{width:20,height:20,borderRadius:"50%",position:"absolute",border:"1px solid white",cursor:"move"},"top-left":{left:-kn,top:-kn},"bottom-left":{left:-kn,bottom:-kn},"top-right":{top:-kn,right:-kn},"bottom-right":{bottom:-kn,right:-kn}},Ln=function(e){var t=e.position,a=e.translation,n=e.onMouseEnter,r=e.onMouseDown,o=e.onMouseUp,i=e.className,c=void 0===i?"":i,s=e.style,l=void 0===s?{}:s;return Object(L.jsx)("div",{onMouseEnter:function(){return n&&n(t)},onMouseDown:function(e){return r(e,t)},onMouseUp:function(){return o(t)},className:c,style:Object(G.a)(Object(G.a)(Object(G.a)(Object(G.a)({},_n.container),_n[t]),l),{},{transform:Nn(a)})})},Bn={position:"relative"},Pn=["top-left","top-right","bottom-right","bottom-left"],Fn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],zn=function(){var e={};return Pn.forEach((function(t){e[t]=[0,0]})),e},Wn=function(e){Object(ie.a)(a,e);var t=Object(ce.a)(a);function a(){var e;Object(re.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).container=void 0,e.layerTranslateDelta=void 0,e.anchorTranslateDelta=void 0,e.isAnchorDragging=!1,e.targetPoints=void 0,e.anchorMoving=void 0,e.state={matrix:Fn,translateDelta:zn(),sourcePoints:void 0,transformOrigin:[0,0],containerTranslate:[e.props.x||0,e.props.y||0]},e.onAnchorMouseDown=function(t,a){t.stopPropagation(),e.anchorTranslateDelta=[t.pageX-e.state.translateDelta[a][0],t.pageY-e.state.translateDelta[a][1]],e.anchorMoving=a},e.onAnchorMouseMove=function(t){if(e.anchorTranslateDelta&&e.state.sourcePoints&&e.anchorMoving){t.preventDefault(),t.stopPropagation();var a=Pn.indexOf(e.anchorMoving),n=t.pageX-e.anchorTranslateDelta[0],r=t.pageY-e.anchorTranslateDelta[1];e.targetPoints[a]=[e.state.sourcePoints[a][0]+n,e.state.sourcePoints[a][1]+r],e.setState({matrix:Gn(e.state.sourcePoints,e.targetPoints),translateDelta:Object(G.a)(Object(G.a)({},e.state.translateDelta),{},Object(et.a)({},e.anchorMoving,[n,r]))})}},e.onAnchorMouseUp=function(t){e.anchorTranslateDelta=void 0,e.anchorMoving=void 0},e.onMouseUp=function(){e.layerTranslateDelta=void 0},e.onMouseMove=function(t){if(e.layerTranslateDelta&&e.props.isEditMode){var a=[t.pageX-e.layerTranslateDelta[0],t.pageY-e.layerTranslateDelta[1]];e.setState({containerTranslate:a})}},e.onMouseDown=function(t){var a=e.state.containerTranslate;e.layerTranslateDelta=[t.pageX-a[0],t.pageY-a[1]]},e}return Object(oe.a)(a,[{key:"componentDidMount",value:function(){if(window.addEventListener("mousemove",this.onAnchorMouseMove),window.addEventListener("mousemove",this.onMouseMove),this.container){var e=this.container.getBoundingClientRect(),t=e.width,a=e.height,n=[[0,0],[t,0],[t,a],[0,a]];if(this.targetPoints=[].concat(n),this.setState({sourcePoints:n}),localStorage.getItem("projMap")){console.log("loading prev. projMap...");var r=localStorage.getItem("projMap");this.setState(JSON.parse(r))}}}},{key:"componentDidUpdate",value:function(e,t){console.log("saving edited projMap...",JSON.stringify(t)),localStorage.setItem("projMap",JSON.stringify(t))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.onAnchorMouseMove),window.removeEventListener("mousemove",this.onMouseMove)}},{key:"render",value:function(){var e=this,t=this.props,a=t.style,n=t.isEditMode,r=t.className,o=t.anchorStyle,i=t.anchorClassName,c=this.state,s=c.translateDelta,l=c.matrix,u=c.containerTranslate,d=c.transformOrigin;return Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)("div",{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,style:{cursor:n?"all-scroll":"inherit",position:"relative",display:"inline-block",transform:Nn(u)},children:[Object(L.jsx)("div",{ref:function(t){e.container=t},style:Object(G.a)(Object(G.a)(Object(G.a)({},Bn),a),{},{pointerEvents:n?"none":"all",transform:An(l),transformOrigin:"".concat(d[0],"px ").concat(d[1],"px 0px")}),className:r,children:this.props.children}),n&&Object(L.jsx)("div",{children:Pn.map((function(t,a){return Object(L.jsx)(Ln,{style:o,className:i,translation:s[t],position:t,onMouseDown:e.onAnchorMouseDown,onMouseUp:e.onAnchorMouseUp},t)}))})]})})}}]),a}(n.Component),Un=a(524),Yn=a.n(Un),Hn=Object(u.a)((function(e){return{button:{margin:e.spacing(1),position:"fixed",bottom:"1vh",zIndex:1001,maxWidth:"50vw"}}}));function Vn(){var e=Hn();return Object(L.jsx)(Ze.a,{container:!0,alignItems:"center",justify:"center",children:Object(L.jsx)(_.a,{variant:"contained",color:"secondary",className:e.button,startIcon:Object(L.jsx)(Yn.a,{}),children:"Reset Projection Mapping"})})}function Jn(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=function(e){var t=e.key;" "===t&&(r((function(e){return!e})),console.log(t,a))};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[a]),Object(L.jsxs)(L.Fragment,{children:[a&&Object(L.jsx)("div",{onClick:function(){return localStorage.getItem("projMap")&&localStorage.removeItem("projMap"),localStorage.getItem("deckGLviewState")&&localStorage.removeItem("deckGLviewState"),void window.location.reload()},children:Object(L.jsx)(Vn,{})}),Object(L.jsx)("div",{style:{height:"100%",width:"100vw",overflow:"hidden",position:"fixed",top:0,left:0,zIndex:1e3},children:Object(L.jsx)("div",{children:Object(L.jsx)(Wn,{style:{height:"100vh",width:"100vw"},isEditMode:a,children:Object(L.jsx)(Rn,{})})})})]})}var Kn=Object(u.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function Xn(e){var t=e.setSelectedTable,a=Kn(),r=Object(n.useState)(),o=Object(m.a)(r,2),i=o[0],c=o[1];return Object(n.useEffect)((function(){var e=[],a=ot.cityIO.ListOfTables,n=ot.cityIO.baseURL;ht.a.get(a).then((function(a){a.data.forEach((function(a){var r="".concat(n).concat(a,"/GEOGRID/");e.push(Object(L.jsx)(_.a,{variant:"outlined",color:"secondary",onClick:function(){ht.a.get(r).then((function(e){200===e.status&&t(a)})).catch((function(e){console.log(e)}))},children:a},Math.random()))})),c(e)}))}),[t]),Object(L.jsx)("div",{className:a.root,children:i})}var qn=function(){var e=Object(le.c)();return Object(n.useEffect)((function(){var t=new WebSocket(ot.SOCKETS.URL);t.onopen=function(){t.send("CityScopeJS"),t.onmessage=function(t){var a=t.data;e(function(e){return{type:Le,data:e}}(!0)),e(function(e){return{type:_e,data:e}}(JSON.parse(a)))}}}),[e]),null};function Qn(){var e=Object(le.d)((function(e){return e.READY})),t=Object(le.d)((function(e){return e.UI_WEBSOCKET_READY})),a=Object(u.a)((function(e){return{root:{"& > *":{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)}}}})),r=Object(n.useState)(null),o=Object(m.a)(r,2),i=o[0],c=o[1],s=function(){return Object(L.jsxs)($.a,{maxWidth:"md",children:[Object(L.jsx)(E.a,{color:"textPrimary",variant:"h1",children:"Projection tool"}),Object(L.jsx)(S.a,{mt:"3em"}),Object(L.jsx)(E.a,{color:"textPrimary",children:"This tool is used to project and display CityScopeJS tables in passive mode, such as projectors, TVs, or other non-interactive displays."}),Object(L.jsx)(S.a,{mt:"2em"}),Object(L.jsx)(E.a,{color:"textPrimary",variant:"caption",children:"start by selecting your CityScopeJS project. Press 'Spacebar' to toggle keystone. Note: Not all CityScope projects below are ready for CityScopeJS."}),Object(L.jsx)(S.a,{mt:"2em"}),Object(L.jsx)(Xn,{setSelectedTable:c})]})},l=a();return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(qn,{}),Object(L.jsxs)(te,{className:l.root,title:"Keystone",children:[!e&&Object(L.jsx)(s,{}),i&&Object(L.jsx)(Dn,{tableName:i}),e&&t&&Object(L.jsx)(Jn,{})]})]})}var Zn=function(e){return console.log("v\xe0o viscontainer111"),Object(L.jsx)(L.Fragment,{children:e.cityIOdata&&Object(L.jsxs)($.a,{children:[Object(L.jsxs)(S.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(L.jsx)(gn,{cityioData:e.cityIOdata}),Object(L.jsx)(On,{cityioData:e.cityIOdata})]}),Object(L.jsx)(Vt.a,{}),Object(L.jsx)(S.a,{display:"flex",alignItems:"center",justifyContent:"center",children:Object(L.jsx)(mn,{cityioData:e.cityIOdata})})]})})},$n=Object(u.a)((function(e){return{root:{margin:"auto",height:"100%",paddingBottom:e.spacing(3),paddingTop:e.spacing(3)}}})),er=function(){var e=Object(Et.a)(It.a.mark((function e(t){var a;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();function tr(e){var t=$n(),a=e.tableName,r=e.cityIOdata,o=e.onlyMap,i=e.onlyOptionMenu,c=(e.onlyChartSidebar,e.mapAndChartSidebar),s=Object(le.d)((function(e){return e.MENU})),l=Object.keys(r),u=ot.menu.toggles,d=Object(le.c)(),p=Object(Xe.a)(s),j=Object(n.useState)("hcm_test_v1"),b=Object(m.a)(j,2),h=b[0],f=b[1],O="hcm_test_v1";function g(){return v.apply(this,arguments)}function v(){return(v=Object(Et.a)(It.a.mark((function e(){var t,n,r,o,i,c,s,j;return It.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,er("".concat("https://cs-map.vlab.tech/api","/get-option"));case 2:return t=e.sent,e.next=5,er("".concat("https://cs-map.vlab.tech/api","/get-scenario"));case 5:n=e.sent,t&&(console.log(t),r=t.table,o=t.option,i=t.mode,r==a&&o&&(c=u[o].requireModule,(l.includes(c)||!1===c)&&(s=p.indexOf(o),"ON"==i?-1===s&&p.push(o):-1!==s&&p.splice(s,1),d(ye(p))))),n&&(console.log(n),(j=n.scenario)&&j!=O&&(console.log(111),O=j,f(j))),setTimeout(g,1e3);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var e=setTimeout(g,1e3);return function(){return clearTimeout(e)}}),[]),Object(L.jsxs)(te,{className:t.root,title:"CitySCopeJS",children:[Object(L.jsx)(Zt,{}),Object(L.jsx)($.a,{maxWidth:null,children:Object(L.jsxs)(Ze.a,{container:!0,spacing:5,children:[i&&Object(L.jsx)(Ze.a,{item:!0,xs:12,l:12,md:12,xl:12,container:!0,children:Object(L.jsx)(Ze.a,{item:!0,container:!0,direction:"column",spacing:2,children:Object(L.jsx)(Ze.a,{item:!0,xs:12,l:12,md:12,xl:12,children:Object(L.jsx)(D.a,{elevation:15,style:{maxHeight:"90vh",overflow:"auto"},children:Object(L.jsx)(T.a,{children:Object(L.jsx)(Qa,{tableName:a})})})})})}),o&&Object(L.jsx)(Ze.a,{item:!0,xs:12,l:12,md:12,xl:12,children:Object(L.jsx)(D.a,{elevation:15,style:{height:"90vh",width:"100%",position:"relative"},children:Object(L.jsx)(bn,{onlyMap:!0})})}),c&&Object(L.jsx)(Ze.a,{item:!0,xs:6,l:6,md:6,xl:6,children:Object(L.jsx)(D.a,{elevation:15,style:{maxHeight:"100%",overflow:"hidden"},children:Object(L.jsx)(Zn,{cityIOdata:r})})}),c&&Object(L.jsx)(Ze.a,{item:!0,xs:6,l:6,md:6,xl:6,children:Object(L.jsx)(D.a,{elevation:15,style:{height:"90vh",width:"100%",overflow:"hidden",position:"relative"},children:Object(L.jsx)(bn,{pitchMap:30,zoomMap:14,autoRotate:!0})})}),Object(L.jsx)(Ze.a,{children:Object(L.jsx)(Xa,{chosenScenario:h})})]})})]})}function ar(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),c=i[0],s=i[1];Object(n.useEffect)((function(){var e=window.location.toString(),t="cityscope=",a=e.substring(e.indexOf(t)+t.length).toLowerCase();-1!==e.indexOf(t)&&a.length>0?r(a):s(!0)}),[]);var l=Object(le.d)((function(e){return e.READY})),u=Object(le.d)((function(e){return e.CITYIO}));return Object(L.jsxs)(L.Fragment,{children:[a&&Object(L.jsx)(At,{tableName:a}),l&&Object(L.jsx)(tr,{cityIOdata:u,tableName:a,onlyMap:!0}),c&&Object(L.jsx)(qt,{}),Object(L.jsx)(Zt,{})]})}function nr(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),c=i[0],s=i[1];Object(n.useEffect)((function(){var e=window.location.toString();console.log(e);var t="cityscope=",a=e.substring(e.indexOf(t)+t.length).toLowerCase();-1!==e.indexOf(t)&&a.length>0?r(a):s(!0)}),[]);var l=Object(le.d)((function(e){return e.READY})),u=Object(le.d)((function(e){return e.CITYIO}));return Object(L.jsxs)(L.Fragment,{children:[a&&Object(L.jsx)(At,{tableName:a}),l&&Object(L.jsx)(tr,{cityIOdata:u,tableName:a,mapAndChartSidebar:!0}),c&&Object(L.jsx)(qt,{}),Object(L.jsx)(Zt,{})]})}function rr(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),c=i[0],s=i[1];Object(n.useEffect)((function(){var e=window.location.toString(),t="cityscope=",a=e.substring(e.indexOf(t)+t.length).toLowerCase();-1!==e.indexOf(t)&&a.length>0?r(a):s(!0)}),[]);var l=Object(le.d)((function(e){return e.READY})),u=Object(le.d)((function(e){return e.CITYIO}));return Object(L.jsxs)(L.Fragment,{children:[a&&Object(L.jsx)(At,{tableName:a}),l&&Object(L.jsx)(tr,{cityIOdata:u,tableName:a,onlyOptionMenu:!0}),c&&Object(L.jsx)(qt,{}),Object(L.jsx)(Zt,{})]})}var or=[{path:"/",element:Object(L.jsx)(Z,{}),children:[{path:"/",element:Object(L.jsx)(Sn,{})},{path:"/onlyMap",element:Object(L.jsx)(ar,{})},{path:"/onlyChartSidebar",element:Object(L.jsx)(nr,{})},{path:"/onlyOptionsMenu",element:Object(L.jsx)(rr,{})},{path:"/editor/",element:Object(L.jsx)(Dt,{})},{path:"/projection",element:Object(L.jsx)(Qn,{})},{path:"/cityioviewer",element:Object(L.jsx)(s.a,{to:"/"})},{path:"*",element:Object(L.jsx)(s.a,{to:"/404"})},{path:"404",element:Object(L.jsx)(ne,{})}]}],ir=function(){var e=Object(s.i)(or);return Object(L.jsxs)(l.a,{theme:O,children:[Object(L.jsx)(j,{}),e]})},cr=function(e){var t=e.children,a=e.store;return Object(L.jsx)(le.a,{store:a,children:t})};i.a.render(Object(L.jsx)(cr,{store:da,children:Object(L.jsx)(c.a,{basename:"https://cs-map.vlab.tech",children:Object(L.jsx)(ir,{})})}),document.getElementById("root"))}},[[662,1,2]]]);
//# sourceMappingURL=main.27e07ac0.chunk.js.map